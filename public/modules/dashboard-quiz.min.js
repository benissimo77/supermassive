class e{constructor(e){this.options={element:null,accept:"*/*",multiple:!1,maxSize:10485760,onDrop:null,onError:null,hoverClass:"dropzone-hover",...e},this.element="string"==typeof this.options.element?document.querySelector(this.options.element):this.options.element,this.element?(this.fileInput=this.element.querySelector('input[type="file"]'),this.fileInput||(this.fileInput=document.createElement("input"),this.fileInput.type="file",this.fileInput.style.display="none",this.element.appendChild(this.fileInput)),this.fileInput.accept=this.options.accept,this.fileInput.multiple=this.options.multiple,this.init()):console.error("Dropzone element not found")}init(){this.element.addEventListener("click",(e=>{e.target!==this.fileInput&&this.fileInput.click()})),this.fileInput.addEventListener("change",(e=>{this.handleFiles(this.fileInput.files)})),this.element.addEventListener("dragover",(e=>{e.preventDefault(),e.stopPropagation(),this.element.classList.add(this.options.hoverClass)})),this.element.addEventListener("dragleave",(e=>{e.preventDefault(),e.stopPropagation(),this.element.classList.remove(this.options.hoverClass)})),this.element.addEventListener("drop",(e=>{e.preventDefault(),e.stopPropagation(),this.element.classList.remove(this.options.hoverClass),e.dataTransfer.files.length>0&&this.handleFiles(e.dataTransfer.files)}))}handleFiles(e){if(0===e.length)return;const t=Array.from(e).filter((e=>{if(e.size>this.options.maxSize)return this.triggerError(`File too large: ${e.name}`),!1;if("*/*"!==this.options.accept){const t=this.options.accept.split(",").map((e=>e.trim())),i=e.type,n="."+e.name.split(".").pop();if(!t.some((e=>{if(e.startsWith("."))return n.toLowerCase()===e.toLowerCase();if(e.endsWith("/*")){const t=e.split("/")[0];return i.startsWith(t+"/")}return i===e})))return this.triggerError(`File type not accepted: ${e.name}`),!1}return!0}));t.length>0&&this.options.onDrop&&this.options.onDrop(t,this.element),this.fileInput.value=""}triggerError(e){this.options.onError?this.options.onError(e):console.error(e)}}function t(){async function t(){try{const e=await fetch("/api/quiz",{method:"GET",headers:{"Content-Type":"application/json"}}),n=await e.json();if(!n.success)throw new Error(n.message||"Failed to fetch quizzes");!function(e){const n=document.getElementById("quiz-item-template"),o=document.getElementById("quiz-items");if(o.innerHTML="",0===e.length)return void(o.innerHTML='<tr><td colspan="2" class="no-quizzes">No quizzes found. Create one to get started!</td></tr>');e.forEach((e=>{const s=n.content.cloneNode(!0),r=s.querySelector("tr");s.querySelector(".quiz-item-title").textContent=e.title,s.querySelector(".delete-quiz-item").addEventListener("click",(i=>{i.stopPropagation(),confirm(`Are you sure you want to delete "${e.title}"?`)&&async function(e){try{const i=await fetch(`/api/quiz/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),n=await i.json();if(!n.success)throw new Error(n.message||"Failed to delete quiz");t()}catch(e){console.error("Error deleting quiz:",e),alert("Error deleting quiz: "+e.message)}}(e._id)})),r.style.cursor="pointer",r.addEventListener("click",(()=>i(e)));const l=s.querySelector(".error-indicator");e.validation&&e.validation.length>0?(l.style.display="inline-flex",l.title=`${e.validation.length} validation issues found`):l.style.display="none",o.appendChild(s)}))}(n.data)}catch(e){console.error("Error fetching quizzes:",e)}}function i(e){window.location.href="/host/dashboard/quizedit.html"+(e&&e._id?`?id=${e._id}`:"")}document.getElementById("create-quiz").addEventListener("click",(function(){i({title:"New Quiz",description:"",rounds:[]})})),new e({element:"#import-quiz-dropzone",accept:".json,application/json",onDrop:e=>{e.length>0&&async function(e){if(alert(`Importing quiz from file: ${e.name}`),!e.name.endsWith(".json")&&"application/json"!==e.type)return void alert("Please select a JSON file.");try{const i=await e.text(),n=JSON.parse(i);delete n._id;const o=await fetch("/api/quiz/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),s=await o.json();s.success?(alert("Quiz imported successfully!"),t()):alert("Failed to import quiz: "+(s.message||"Unknown error"))}catch(e){console.error("Error importing quiz:",e),alert("Error importing quiz. Please ensure it is a valid JSON file.")}}(e[0])},onError:e=>{alert(e)}}),t()}export{t as initDashboardQuiz};
//# sourceMappingURL=dashboard-quiz.min.js.map
