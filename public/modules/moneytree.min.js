!function(){"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e,s=t(Phaser);class n extends s.default.Scene{init(){console.log(`${this.scene.key}:: BaseScene.init: hello`),this.resizeHandler=t=>{this.handleResize(t)},this.shutdownHandler=()=>{this.shutdown()},this.scale.on("resize",this.resizeHandler),this.events.on("shutdown",this.shutdownHandler),this.handleResize(this.scale.gameSize);const t=this.plugins.get("SocketManagerPlugin");if(!t)throw new Error("SocketManagerPlugin not found");const e=t.getSocket();if(!e)throw new Error("Socket not initialized");this.socket=e,this.socket.on("connection",(function(t){console.log("Connected to server:",t)}))}handleResize(t){console.log(`${this.scene.key}:: BaseScene.handleResize:`,t.width,t.height);const e=t.width/1920,s=t.height/e,n=this.cameras.main;n.setOrigin(0,0),n.setZoom(e),this.updateHeight(s)}updateHeight(t){console.log("BaseScene:: updateHeight:",t),n.currentHeight=t}getY(t){return t*this.getScaleFactor()}getScaleFactor(){return n.currentHeight/1080}shutdown(){console.log("BaseScene:: shutdown"),this.scale.off("resize",this.resizeHandler),this.events.off("shutdown",this.shutdownHandler),this.socket.removeAllListeners(),this.sceneShutdown()}}n.currentHeight=1080;class o{constructor(t,e,s){this.persistentCallbacks=[],this.singleUseCallbacks=[],this.state=t,this.transitions=e,this.stateActions=s}start(){console.log(`Starting FSM in state: ${this.state}`),this.handleStateChange(this.state)}nextState(){const t=this.transitions[this.state];if(!(t.length>0))throw new Error(`No available transitions from ${this.state}`);{const e=t[0];this.transitionTo(e)}}canTransitionTo(t){return this.transitions[this.state]?.includes(t)??!1}transitionTo(t){if(console.log(`Transitioning from ${this.state} to ${t}`),!this.canTransitionTo(t))throw new Error(`Invalid transition from ${this.state} to ${t}`);this.forceTransitionTo(t)}forceTransitionTo(t){const e=this.state;this.state=t,this.persistentCallbacks.forEach((s=>s(t,e))),this.singleUseCallbacks.forEach((s=>s(t,e))),this.singleUseCallbacks=[],this.handleStateChange(t)}onStateChange(t){this.persistentCallbacks.push(t)}onNextStateChange(t){this.singleUseCallbacks.push(t)}handleStateChange(t){const e=this.stateActions[t];e&&e()}getState(){return this.state}getAllStates(){return Object.keys(this.stateActions)}}!function(t){t.SPLASH="SPLASH",t.INTRO="INTRO",t.CHOOSE_ENVELOPE="CHOOSE_ENVELOPE",t.INTRO_ROUND="INTRO_ROUND",t.QUESTION="QUESTION",t.ANSWER="ANSWER",t.END_ROUND="END_ROUND",t.FINAL_CHOICE="FINAL_CHOICE",t.PLAY_SAFE="PLAY_SAFE",t.CHECK_ENVELOPE="CHECK_ENVELOPE",t.GAMBLE="GAMBLE",t.GAMBLE_WON="GAMBLE_WON",t.GAMBLE_LOST="GAMBLE_LOST",t.ALLIN="ALLIN",t.ALLIN_WON="ALLIN_WON",t.ALLIN_LOST="ALLIN_LOST",t.END_QUIZ="END_QUIZ",t.SAVE_RESULTS="SAVE_RESULTS",t.DEBUG="DEBUG"}(e||(e={}));var i=e;class r{constructor(t,e,s){this.scene=t,this.fsm=e,this.mockStateCallback=s,this.buildUI()}buildUI(){this.container=this.scene.add.container(10,10).setDepth(9999);const t=this.scene.add.rectangle(0,0,200,300,0,.7).setOrigin(0).setScrollFactor(0);this.container.add(t);const e=this.fsm.getAllStates();let s=10;e.forEach((t=>{const e=this.scene.add.text(10,s,t,{font:"16px monospace",color:"#ffffff",backgroundColor:"#333333",padding:{x:5,y:5}}).setData("name",t).setInteractive({useHandCursor:!0}).setScrollFactor(0);e.on("pointerdown",(()=>{this.transitionTo(t)})),this.container.add(e),s+=30})),this.fsm.onStateChange((t=>this.showState(t))),this.hide()}showState(t){console.log("StateDebugger: showState:",t),this.container.getAll().forEach((e=>{if(e instanceof Phaser.GameObjects.Text){const s=e.getData("name")===t;e.setStyle({backgroundColor:s?"#666666":"#333333"})}}))}transitionTo(t){console.log(`Debug: Forcing transition to state: ${t}`),this.mockStateCallback(t),this.fsm.forceTransitionTo(t)}show(){this.container.setVisible(!0)}hide(){this.container.setVisible(!1)}toggle(){this.container.setVisible(!this.container.visible)}}const a="#ffffff";class h extends Phaser.GameObjects.Container{constructor(t,e){super(t),this.text=t.add.text(0,0,`${e}`).setFontFamily("Arial").setFontStyle("bold").setFontSize(t.getY(24)).setColor(a).setOrigin(.5);const s=t.getY(6),n=this.text.width+40,o=this.text.height+2*s;this.background=t.add.rectangle(0,0,n,o).setOrigin(.5,.5).setStrokeStyle(1),this.setSlotState("empty"),this.add([this.background,this.text])}setSlotState(t){"empty"==t?(this.background.setFillStyle(Phaser.Display.Color.HexStringToColor("#5555AA").color),this.background.setStrokeStyle(.5,Phaser.Display.Color.HexStringToColor("#aaaaff").color),this.text.setColor(a)):(this.background.setFillStyle(Phaser.Display.Color.HexStringToColor("#333333").color),this.background.setStrokeStyle(.5,Phaser.Display.Color.HexStringToColor("#555555").color),this.text.setColor("#000000")),this.state=t}setText(t,e=20){this.text.setText(`${t}`);const s=this.text.width+2*e,n=this.text.height+2*e;this.background.setSize(s,n)}highlightSlot(){this.background.setFillStyle(Phaser.Display.Color.HexStringToColor("#ffff00").color),this.background.setStrokeStyle(4,Phaser.Display.Color.HexStringToColor("#5555AA").color),this.text.setColor("#000000")}unhighlightSlot(){this.setSlotState(this.state)}setBackgroundColor(t){this.background.setFillStyle(Phaser.Display.Color.HexStringToColor(t).color)}setBorderColor(t){this.background.setStrokeStyle(4,Phaser.Display.Color.HexStringToColor(t).color)}setTextColor(t){this.text.setColor(t)}destroy(){this.destroy()}}class c extends Phaser.GameObjects.Container{constructor(t,e,s,n,o){super(t,s,0),this.slots=[],this.slotData=e,this.createTree(n,o)}createTree(t,e){const s=(e-t)/(this.slotData.length-1);for(let e=0;e<this.slotData.length;e++){const n=new h(this.scene,this.slotData[e]);n.setX(0),n.setY(t+e*s),this.add(n),this.slots.push(n)}}animateCorrectAnswer(t,e){console.log("Slots:",this.slots),this.slots.map((t=>{console.log("slot:",t.state)}));const s=this.slots.map(((t,e)=>({slot:t,i:e}))).filter((({slot:t})=>"revealed"!==t.state)).map((({i:t})=>t));if(0===s.length)return void console.warn("No available slots to animate!");const n=s.indexOf(t);if(-1===n)return void console.error("Target index not in available slots!");console.log("Available indices:",s,"Target Index:",n);var o=[s[0]];Phaser.Math.Between(1,100)>0&&(o=s.slice().reverse());for(var i=0;i<Phaser.Math.Between(1,4);i++)o=o.concat(s.slice(1),s.slice(0,-1).reverse());n>0&&(o=o.concat(s.slice(1,n),s[n])),console.log("Journey:",o);const r=this.buildDistanceLUT();r[r.length-1]=1;var a=this.slots[o[0]];this.scene.tweens.addCounter({from:0,to:1,duration:o.length*Phaser.Math.Between(40,70),onUpdate:t=>{const e=t.getValue(),s=Math.round(e*(r.length-1)),n=r[s],i=Math.min(Math.round(n*(o.length-1)),o.length-1),h=this.slots[o[i]];h!==a&&(this.scene.sound.play("lowtick",{volume:.5}),h.highlightSlot(),a.unhighlightSlot(),a=h)},onComplete:()=>{console.log("onComplete: adding tween chain:",this.scene.time.timeScale,this.scene.tweens,this.slots,this.slots[t]),this.scene.sound.play("highlightslot");const s=this.scene.tweens.chain({targets:this.slots[t],tweens:[{scale:1,duration:200,onComplete:()=>{this.slots[t].unhighlightSlot()}},{scale:1,duration:70,onComplete:()=>{this.slots[t].highlightSlot()}}],repeat:4,onComplete:()=>{console.log("chain onComplete...:",s.timeScale,this.scene.time.timeScale),e()}})}})}speedCurve(t){return Math.pow(1-t,Phaser.Math.Between(15,25)/10)}buildDistanceLUT(t=1e3){const e=[];let s=0,n=0;for(let e=0;e<t;e++){const s=e/(t-1);n+=this.speedCurve(s)}for(let o=0;o<t;o++){const i=o/(t-1);s+=this.speedCurve(i),e.push(s/n)}return e}getEmptySlots(){return this.slots.filter((t=>"empty"===t.state))}getSlotIndex(t){return this.slots.indexOf(t)}getSlotByIndex(t){return this.slots[t]}updateSlots(t,e,s){for(const n of this.slots)n.setBackgroundColor(t),n.setTextColor(e),n.setBorderColor(s)}getSlotData(){return this.slotData}getAllSlots(){return this.slots}updateSlot(t,e,s,n){const o=this.slots[t];o.setBackgroundColor(e),o.setTextColor(s),o.setBorderColor(n)}setSlotState(t,e){this.slots[t].setSlotState(e)}setSlotText(t,e){this.slots[t].setText(e)}destroy(){super.destroy(!0)}}const l=Object.create(null);l.open="0",l.close="1",l.ping="2",l.pong="3",l.message="4",l.upgrade="5",l.noop="6";const u=Object.create(null);Object.keys(l).forEach((t=>{u[l[t]]=t}));const d={type:"error",data:"parser error"},f="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),p="function"==typeof ArrayBuffer,g=t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,y=({type:t,data:e},s,n)=>f&&e instanceof Blob?s?n(e):m(e,n):p&&(e instanceof ArrayBuffer||g(e))?s?n(e):m(new Blob([e]),n):n(l[t]+(e||"")),m=(t,e)=>{const s=new FileReader;return s.onload=function(){const t=s.result.split(",")[1];e("b"+(t||""))},s.readAsDataURL(t)};function w(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let b;const v="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let t=0;t<64;t++)v["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;const x="function"==typeof ArrayBuffer,S=(t,e)=>{if("string"!=typeof t)return{type:"message",data:A(t,e)};const s=t.charAt(0);return"b"===s?{type:"message",data:C(t.substring(1),e)}:u[s]?t.length>1?{type:u[s],data:t.substring(1)}:{type:u[s]}:d},C=(t,e)=>{if(x){const s=(t=>{let e,s,n,o,i,r=.75*t.length,a=t.length,h=0;"="===t[t.length-1]&&(r--,"="===t[t.length-2]&&r--);const c=new ArrayBuffer(r),l=new Uint8Array(c);for(e=0;e<a;e+=4)s=v[t.charCodeAt(e)],n=v[t.charCodeAt(e+1)],o=v[t.charCodeAt(e+2)],i=v[t.charCodeAt(e+3)],l[h++]=s<<2|n>>4,l[h++]=(15&n)<<4|o>>2,l[h++]=(3&o)<<6|63&i;return c})(t);return A(s,e)}return{base64:!0,data:t}},A=(t,e)=>"blob"===e?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,k=String.fromCharCode(30);let q;function I(t){return t.reduce(((t,e)=>t+e.length),0)}function _(t,e){if(t[0].length===e)return t.shift();const s=new Uint8Array(e);let n=0;for(let o=0;o<e;o++)s[o]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),s}function E(t){if(t)return function(t){for(var e in E.prototype)t[e]=E.prototype[e];return t}(t)}E.prototype.on=E.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},E.prototype.once=function(t,e){function s(){this.off(t,s),e.apply(this,arguments)}return s.fn=e,this.on(t,s),this},E.prototype.off=E.prototype.removeListener=E.prototype.removeAllListeners=E.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var s,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<n.length;o++)if((s=n[o])===e||s.fn===e){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},E.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),s=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(s){n=0;for(var o=(s=s.slice(0)).length;n<o;++n)s[n].apply(this,e)}return this},E.prototype.emitReserved=E.prototype.emit,E.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},E.prototype.hasListeners=function(t){return!!this.listeners(t).length};const T="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),O="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function N(t,...e){return e.reduce(((e,s)=>(t.hasOwnProperty(s)&&(e[s]=t[s]),e)),{})}const F=O.setTimeout,L=O.clearTimeout;function W(t,e){e.useNativeTimers?(t.setTimeoutFn=F.bind(O),t.clearTimeoutFn=L.bind(O)):(t.setTimeoutFn=O.setTimeout.bind(O),t.clearTimeoutFn=O.clearTimeout.bind(O))}function B(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class R extends Error{constructor(t,e,s){super(t),this.description=e,this.context=s,this.type="TransportError"}}class M extends E{constructor(t){super(),this.writable=!1,W(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,s){return super.emitReserved("error",new R(t,e,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=S(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return-1===t.indexOf(":")?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(t){const e=function(t){let e="";for(let s in t)t.hasOwnProperty(s)&&(e.length&&(e+="&"),e+=encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return e}(t);return e.length?"?"+e:""}}class P extends M{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let t=0;this._polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){((t,e)=>{const s=t.split(k),n=[];for(let t=0;t<s.length;t++){const o=S(s[t],e);if(n.push(o),"error"===o.type)break}return n})(t,this.socket.binaryType).forEach((t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)})),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,((t,e)=>{const s=t.length,n=new Array(s);let o=0;t.forEach(((t,i)=>{y(t,!1,(t=>{n[i]=t,++o===s&&e(n.join(k))}))}))})(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=B()),this.supportsBinary||e.sid||(e.b64=1),this.createUri(t,e)}}let D=!1;try{D="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){}const Y=D;function U(){}class H extends P{constructor(t){if(super(t),"undefined"!=typeof location){const e="https:"===location.protocol;let s=location.port;s||(s=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,e){const s=this.request({method:"POST",data:t});s.on("success",e),s.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)})),this.pollXhr=t}}class z extends E{constructor(t,e,s){super(),this.createRequest=t,W(this,s),this._opts=s,this._method=s.method||"GET",this._uri=e,this._data=void 0!==s.data?s.data:null,this._create()}_create(){var t;const e=N(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(e);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let t in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(t)&&s.setRequestHeader(t,this._opts.extraHeaders[t])}}catch(t){}if("POST"===this._method)try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{s.setRequestHeader("Accept","*/*")}catch(t){}null===(t=this._opts.cookieJar)||void 0===t||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var t;3===s.readyState&&(null===(t=this._opts.cookieJar)||void 0===t||t.parseCookies(s.getResponseHeader("set-cookie"))),4===s.readyState&&(200===s.status||1223===s.status?this._onLoad():this.setTimeoutFn((()=>{this._onError("number"==typeof s.status?s.status:0)}),0))},s.send(this._data)}catch(t){return void this.setTimeoutFn((()=>{this._onError(t)}),0)}"undefined"!=typeof document&&(this._index=z.requestsCount++,z.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=U,t)try{this._xhr.abort()}catch(t){}"undefined"!=typeof document&&delete z.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}function j(){for(let t in z.requests)z.requests.hasOwnProperty(t)&&z.requests[t].abort()}z.requestsCount=0,z.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",j):"function"==typeof addEventListener&&addEventListener("onpagehide"in O?"pagehide":"unload",j,!1));const G=function(){const t=Q({xdomain:!1});return t&&null!==t.responseType}();function Q(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||Y))return new XMLHttpRequest}catch(t){}if(!e)try{return new(O[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}const $="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class V extends M{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,s=$?{}:N(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,s)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;y(s,this.supportsBinary,(t=>{try{this.doWrite(s,t)}catch(t){}n&&T((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=B()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const K=O.WebSocket||O.MozWebSocket,J={websocket:class extends V{createSocket(t,e,s){return $?new K(t,e,s):e?new K(t,e):new K(t)}doWrite(t,e){this.ws.send(e)}},webtransport:class extends M{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then((()=>{this.onClose()})).catch((t=>{this.onError("webtransport error",t)})),this._transport.ready.then((()=>{this._transport.createBidirectionalStream().then((t=>{const e=function(t,e){q||(q=new TextDecoder);const s=[];let n=0,o=-1,i=!1;return new TransformStream({transform(r,a){for(s.push(r);;){if(0===n){if(I(s)<1)break;const t=_(s,1);i=!(128&~t[0]),o=127&t[0],n=o<126?3:126===o?1:2}else if(1===n){if(I(s)<2)break;const t=_(s,2);o=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),n=3}else if(2===n){if(I(s)<8)break;const t=_(s,8),e=new DataView(t.buffer,t.byteOffset,t.length),i=e.getUint32(0);if(i>Math.pow(2,21)-1){a.enqueue(d);break}o=i*Math.pow(2,32)+e.getUint32(4),n=3}else{if(I(s)<o)break;const t=_(s,o);a.enqueue(S(i?t:q.decode(t),e)),n=0}if(0===o||o>t){a.enqueue(d);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(e).getReader(),n=new TransformStream({transform(t,e){!function(t,e){f&&t.data instanceof Blob?t.data.arrayBuffer().then(w).then(e):p&&(t.data instanceof ArrayBuffer||g(t.data))?e(w(t.data)):y(t,!1,(t=>{b||(b=new TextEncoder),e(b.encode(t))}))}(t,(s=>{const n=s.length;let o;if(n<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,n);else if(n<65536){o=new Uint8Array(3);const t=new DataView(o.buffer);t.setUint8(0,126),t.setUint16(1,n)}else{o=new Uint8Array(9);const t=new DataView(o.buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(n))}t.data&&"string"!=typeof t.data&&(o[0]|=128),e.enqueue(o),e.enqueue(s)}))}});n.readable.pipeTo(t.writable),this._writer=n.writable.getWriter();const o=()=>{s.read().then((({done:t,value:e})=>{t||(this.onPacket(e),o())})).catch((t=>{}))};o();const i={type:"open"};this.query.sid&&(i.data=`{"sid":"${this.query.sid}"}`),this._writer.write(i).then((()=>this.onOpen()))}))}))}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;this._writer.write(s).then((()=>{n&&T((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var t;null===(t=this._transport)||void 0===t||t.close()}},polling:class extends H{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=G&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new z(Q,this.uri(),t)}}},Z=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,X=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function tt(t){if(t.length>8e3)throw"URI too long";const e=t,s=t.indexOf("["),n=t.indexOf("]");-1!=s&&-1!=n&&(t=t.substring(0,s)+t.substring(s,n).replace(/:/g,";")+t.substring(n,t.length));let o=Z.exec(t||""),i={},r=14;for(;r--;)i[X[r]]=o[r]||"";return-1!=s&&-1!=n&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function(t,e){const s=e.replace(/\/{2,9}/g,"/").split("/");return"/"!=e.slice(0,1)&&0!==e.length||s.splice(0,1),"/"==e.slice(-1)&&s.splice(s.length-1,1),s}(0,i.path),i.queryKey=function(t,e){const s={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(s[e]=n)})),s}(0,i.query),i}const et="function"==typeof addEventListener&&"function"==typeof removeEventListener,st=[];et&&addEventListener("offline",(()=>{st.forEach((t=>t()))}),!1);class nt extends E{constructor(t,e){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&"object"==typeof t&&(e=t,t=null),t){const s=tt(t);e.hostname=s.host,e.secure="https"===s.protocol||"wss"===s.protocol,e.port=s.port,s.query&&(e.query=s.query)}else e.host&&(e.hostname=tt(e.host).host);W(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach((t=>{const e=t.prototype.name;this.transports.push(e),this._transportsByName[e]=t})),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(t){let e={},s=t.split("&");for(let t=0,n=s.length;t<n;t++){let n=s[t].split("=");e[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return e}(this.opts.query)),et&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},st.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const s=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);const t=this.opts.rememberUpgrade&&nt.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",(t=>this._onClose("transport close",t)))}onOpen(){this.readyState="open",nt.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn((()=>{this._onClose("ping timeout")}),t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const n=this.writeBuffer[s].data;if(n&&(t+="string"==typeof(e=n)?function(t){let e=0,s=0;for(let n=0,o=t.length;n<o;n++)e=t.charCodeAt(n),e<128?s+=1:e<2048?s+=2:e<55296||e>=57344?s+=3:(n++,s+=4);return s}(e):Math.ceil(1.33*(e.byteLength||e.size))),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}var e;return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,T((()=>{this._onClose("ping timeout")}),this.setTimeoutFn)),t}write(t,e,s){return this._sendPacket("message",t,e,s),this}send(t,e,s){return this._sendPacket("message",t,e,s),this}_sendPacket(t,e,s,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof s&&(n=s,s=null),"closing"===this.readyState||"closed"===this.readyState)return;(s=s||{}).compress=!1!==s.compress;const o={type:t,data:e,options:s};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},s=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?s():t()})):this.upgrading?s():t()),this}_onError(t){if(nt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),et&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const t=st.indexOf(this._offlineEventListener);-1!==t&&st.splice(t,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}nt.protocol=4;class ot extends nt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),s=!1;nt.priorWebsocketSuccess=!1;const n=()=>{s||(e.send([{type:"ping",data:"probe"}]),e.once("packet",(t=>{if(!s)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;nt.priorWebsocketSuccess="websocket"===e.name,this.transport.pause((()=>{s||"closed"!==this.readyState&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())}))}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}})))};function o(){s||(s=!0,c(),e.close(),e=null)}const i=t=>{const s=new Error("probe error: "+t);s.transport=e.name,o(),this.emitReserved("upgradeError",s)};function r(){i("transport closed")}function a(){i("socket closed")}function h(t){e&&t.name!==e.name&&o()}const c=()=>{e.removeListener("open",n),e.removeListener("error",i),e.removeListener("close",r),this.off("close",a),this.off("upgrading",h)};e.once("open",n),e.once("error",i),e.once("close",r),this.once("close",a),this.once("upgrading",h),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn((()=>{s||e.open()}),200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&e.push(t[s]);return e}}class it extends ot{constructor(t,e={}){const s="object"==typeof t?t:e;(!s.transports||s.transports&&"string"==typeof s.transports[0])&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map((t=>J[t])).filter((t=>!!t))),super(t,s)}}const rt="function"==typeof ArrayBuffer,at=Object.prototype.toString,ht="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===at.call(Blob),ct="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===at.call(File);function lt(t){return rt&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||ht&&t instanceof Blob||ct&&t instanceof File}function ut(t,e){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let e=0,s=t.length;e<s;e++)if(ut(t[e]))return!0;return!1}if(lt(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return ut(t.toJSON(),!0);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&ut(t[e]))return!0;return!1}function dt(t){const e=[],s=t.data,n=t;return n.data=ft(s,e),n.attachments=e.length,{packet:n,buffers:e}}function ft(t,e){if(!t)return t;if(lt(t)){const s={_placeholder:!0,num:e.length};return e.push(t),s}if(Array.isArray(t)){const s=new Array(t.length);for(let n=0;n<t.length;n++)s[n]=ft(t[n],e);return s}if("object"==typeof t&&!(t instanceof Date)){const s={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=ft(t[n],e));return s}return t}function pt(t,e){return t.data=gt(t.data,e),delete t.attachments,t}function gt(t,e){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=gt(t[s],e);else if("object"==typeof t)for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=gt(t[s],e));return t}const yt=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var mt;function wt(t){return"[object Object]"===Object.prototype.toString.call(t)}!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(mt||(mt={}));class bt extends E{constructor(t){super(),this.reviver=t}add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const s=e.type===mt.BINARY_EVENT;s||e.type===mt.BINARY_ACK?(e.type=s?mt.EVENT:mt.ACK,this.reconstructor=new vt(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!lt(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const s={type:Number(t.charAt(0))};if(void 0===mt[s.type])throw new Error("unknown packet type "+s.type);if(s.type===mt.BINARY_EVENT||s.type===mt.BINARY_ACK){const n=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const o=t.substring(n,e);if(o!=Number(o)||"-"!==t.charAt(e))throw new Error("Illegal attachments");s.attachments=Number(o)}if("/"===t.charAt(e+1)){const n=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);s.nsp=t.substring(n,e)}else s.nsp="/";const n=t.charAt(e+1);if(""!==n&&Number(n)==n){const n=e+1;for(;++e;){const s=t.charAt(e);if(null==s||Number(s)!=s){--e;break}if(e===t.length)break}s.id=Number(t.substring(n,e+1))}if(t.charAt(++e)){const n=this.tryParse(t.substr(e));if(!bt.isPayloadValid(s.type,n))throw new Error("invalid payload");s.data=n}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}static isPayloadValid(t,e){switch(t){case mt.CONNECT:return wt(e);case mt.DISCONNECT:return void 0===e;case mt.CONNECT_ERROR:return"string"==typeof e||wt(e);case mt.EVENT:case mt.BINARY_EVENT:return Array.isArray(e)&&("number"==typeof e[0]||"string"==typeof e[0]&&-1===yt.indexOf(e[0]));case mt.ACK:case mt.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class vt{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=pt(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}var xt=Object.freeze({__proto__:null,protocol:5,get PacketType(){return mt},Encoder:class{constructor(t){this.replacer=t}encode(t){return t.type!==mt.EVENT&&t.type!==mt.ACK||!ut(t)?[this.encodeAsString(t)]:this.encodeAsBinary({type:t.type===mt.EVENT?mt.BINARY_EVENT:mt.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})}encodeAsString(t){let e=""+t.type;return t.type!==mt.BINARY_EVENT&&t.type!==mt.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=dt(t),s=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(s),n}},Decoder:bt});function St(t,e,s){return t.on(e,s),function(){t.off(e,s)}}const Ct=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class At extends E{constructor(t,e,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[St(t,"open",this.onopen.bind(this)),St(t,"packet",this.onpacket.bind(this)),St(t,"error",this.onerror.bind(this)),St(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var s,n,o;if(Ct.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const i={type:mt.EVENT,data:e,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++,s=e.pop();this._registerAckCallback(t,s),i.id=t}const r=null===(n=null===(s=this.io.engine)||void 0===s?void 0:s.transport)||void 0===n?void 0:n.writable,a=this.connected&&!(null===(o=this.io.engine)||void 0===o?void 0:o._hasPingExpired());return this.flags.volatile&&!r||(a?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(t,e){var s;const n=null!==(s=this.flags.timeout)&&void 0!==s?s:this._opts.ackTimeout;if(void 0===n)return void(this.acks[t]=e);const o=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))}),n),i=(...t)=>{this.io.clearTimeoutFn(o),e.apply(this,t)};i.withError=!0,this.acks[t]=i}emitWithAck(t,...e){return new Promise(((s,n)=>{const o=(t,e)=>t?n(t):s(e);o.withError=!0,e.push(o),this.emit(t,...e)}))}_addToQueue(t){let e;"function"==typeof t[t.length-1]&&(e=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push(((t,...n)=>{if(s===this._queue[0])return null!==t?s.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(t)):(this._queue.shift(),e&&e(null,...n)),s.pending=!1,this._drainQueue()})),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||0===this._queue.length)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth((t=>{this._sendConnectPacket(t)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:mt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((t=>{if(!this.sendBuffer.some((e=>String(e.id)===t))){const e=this.acks[t];delete this.acks[t],e.withError&&e.call(this,new Error("socket has been disconnected"))}}))}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case mt.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case mt.EVENT:case mt.BINARY_EVENT:this.onevent(t);break;case mt.ACK:case mt.BINARY_ACK:this.onack(t);break;case mt.DISCONNECT:this.ondisconnect();break;case mt.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const s of e)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&"string"==typeof t[t.length-1]&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let s=!1;return function(...n){s||(s=!0,e.packet({type:mt.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t),this.packet(t)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:mt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const s of e)s.apply(this,t.data)}}}function kt(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}kt.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),s=Math.floor(e*this.jitter*t);t=1&Math.floor(10*e)?t+s:t-s}return 0|Math.min(t,this.max)},kt.prototype.reset=function(){this.attempts=0},kt.prototype.setMin=function(t){this.ms=t},kt.prototype.setMax=function(t){this.max=t},kt.prototype.setJitter=function(t){this.jitter=t};class qt extends E{constructor(t,e){var s;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,W(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(s=e.randomizationFactor)&&void 0!==s?s:.5),this.backoff=new kt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const n=e.parser||xt;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new it(this.uri,this.opts);const e=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const n=St(e,"open",(function(){s.onopen(),t&&t()})),o=e=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",e),t?t(e):this.maybeReconnectOnOpen()},i=St(e,"error",o);if(!1!==this._timeout){const t=this._timeout,s=this.setTimeoutFn((()=>{n(),o(new Error("timeout")),e.close()}),t);this.opts.autoUnref&&s.unref(),this.subs.push((()=>{this.clearTimeoutFn(s)}))}return this.subs.push(n),this.subs.push(i),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(St(t,"ping",this.onping.bind(this)),St(t,"data",this.ondata.bind(this)),St(t,"error",this.onerror.bind(this)),St(t,"close",this.onclose.bind(this)),St(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){T((()=>{this.emitReserved("packet",t)}),this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new At(this,t,e),this.nsps[t]=s),s}_destroy(t){const e=Object.keys(this.nsps);for(const t of e)if(this.nsps[t].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let s=0;s<e.length;s++)this.engine.write(e[s],t.options)}cleanup(){this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var s;this.cleanup(),null===(s=this.engine)||void 0===s||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn((()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()})))}),e);this.opts.autoUnref&&s.unref(),this.subs.push((()=>{this.clearTimeoutFn(s)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const It={};function _t(t,e){"object"==typeof t&&(e=t,t=void 0);const s=function(t,e="",s){let n=t;s=s||"undefined"!=typeof location&&location,null==t&&(t=s.protocol+"//"+s.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?s.protocol+t:s.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==s?s.protocol+"//"+t:"https://"+t),n=tt(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port+e,n.href=n.protocol+"://"+o+(s&&s.port===n.port?"":":"+n.port),n}(t,(e=e||{}).path||"/socket.io"),n=s.source,o=s.id,i=s.path,r=It[o]&&i in It[o].nsps;let a;return e.forceNew||e["force new connection"]||!1===e.multiplex||r?a=new qt(n,e):(It[o]||(It[o]=new qt(n,e)),a=It[o]),s.query&&!e.query&&(e.query=s.queryKey),a.socket(s.path,e)}Object.assign(_t,{Manager:qt,Socket:At,io:_t,connect:_t});class Et extends s.default.Plugins.BasePlugin{constructor(t){super(t),console.log("SocketManagerPlugin constructor")}init(){console.log("SocketManagerPlugin:: init"),this.socket=_t(),this.socket.on("connection",(t=>{console.log("SocketManager: Connected to server:",t)}))}getSocket(){return this.socket}disconnect(){this.socket&&this.socket.disconnect()}}function Tt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}console.log("SocketManager loaded...");var Ot,Nt,Ft={exports:{}},Lt=(Ot||(Ot=1,Nt=Ft,function(){function t(t,e,s){return t.call.apply(t.bind,arguments)}function e(t,e,s){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,n),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function s(n,o,i){return(s=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?t:e).apply(null,arguments)}var n=Date.now||function(){return+new Date};function o(t,e){this.a=t,this.o=e||t,this.c=this.o.document}var i=!!window.FontFace;function r(t,e,s,n){if(e=t.c.createElement(e),s)for(var o in s)s.hasOwnProperty(o)&&("style"==o?e.style.cssText=s[o]:e.setAttribute(o,s[o]));return n&&e.appendChild(t.c.createTextNode(n)),e}function a(t,e,s){(t=t.c.getElementsByTagName(e)[0])||(t=document.documentElement),t.insertBefore(s,t.lastChild)}function h(t){t.parentNode&&t.parentNode.removeChild(t)}function c(t,e,s){e=e||[],s=s||[];for(var n=t.className.split(/\s+/),o=0;o<e.length;o+=1){for(var i=!1,r=0;r<n.length;r+=1)if(e[o]===n[r]){i=!0;break}i||n.push(e[o])}for(e=[],o=0;o<n.length;o+=1){for(i=!1,r=0;r<s.length;r+=1)if(n[o]===s[r]){i=!0;break}i||e.push(n[o])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function l(t,e){for(var s=t.className.split(/\s+/),n=0,o=s.length;n<o;n++)if(s[n]==e)return!0;return!1}function u(t,e,s){function n(){l&&o&&h&&(l(c),l=null)}e=r(t,"link",{rel:"stylesheet",href:e,media:"all"});var o=!1,h=!0,c=null,l=s||null;i?(e.onload=function(){o=!0,n()},e.onerror=function(){o=!0,c=Error("Stylesheet failed to load"),n()}):setTimeout((function(){o=!0,n()}),0),a(t,"head",e)}function d(t,e,s,n){var o=t.c.getElementsByTagName("head")[0];if(o){var i=r(t,"script",{src:e}),a=!1;return i.onload=i.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,s&&s(null),i.onload=i.onreadystatechange=null,"HEAD"==i.parentNode.tagName&&o.removeChild(i))},o.appendChild(i),setTimeout((function(){a||(a=!0,s&&s(Error("Script load timeout")))}),n||5e3),i}return null}function f(){this.a=0,this.c=null}function p(t){return t.a++,function(){t.a--,y(t)}}function g(t,e){t.c=e,y(t)}function y(t){0==t.a&&t.c&&(t.c(),t.c=null)}function m(t){this.a=t||"-"}function w(t,e){this.c=t,this.f=4,this.a="n";var s=(e||"n4").match(/^([nio])([1-9])$/i);s&&(this.a=s[1],this.f=parseInt(s[2],10))}function b(t){var e=[];t=t.split(/,\s*/);for(var s=0;s<t.length;s++){var n=t[s].replace(/['"]/g,"");-1!=n.indexOf(" ")||/^\d/.test(n)?e.push("'"+n+"'"):e.push(n)}return e.join(",")}function v(t){return t.a+t.f}function x(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function S(t){var e=4,s="n",n=null;return t&&((n=t.match(/(normal|oblique|italic)/i))&&n[1]&&(s=n[1].substr(0,1).toLowerCase()),(n=t.match(/([1-9]00|normal|bold)/i))&&n[1]&&(/bold/i.test(n[1])?e=7:/[1-9]00/.test(n[1])&&(e=parseInt(n[1].substr(0,1),10)))),s+e}function C(t,e){this.c=t,this.f=t.o.document.documentElement,this.h=e,this.a=new m("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function A(t){if(t.g){var e=l(t.f,t.a.c("wf","active")),s=[],n=[t.a.c("wf","loading")];e||s.push(t.a.c("wf","inactive")),c(t.f,s,n)}k(t,"inactive")}function k(t,e,s){t.j&&t.h[e]&&(s?t.h[e](s.c,v(s)):t.h[e]())}function q(){this.c={}}function I(t,e){this.c=t,this.f=e,this.a=r(this.c,"span",{"aria-hidden":"true"},this.f)}function _(t){a(t.c,"body",t.a)}function E(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+b(t.c)+";font-style:"+x(t)+";font-weight:"+t.f+"00;"}function T(t,e,s,n,o,i){this.g=t,this.j=e,this.a=n,this.c=s,this.f=o||3e3,this.h=i||void 0}function O(t,e,s,n,o,i,r){this.v=t,this.B=e,this.c=s,this.a=n,this.s=r||"BESbswy",this.f={},this.w=o||3e3,this.u=i||null,this.m=this.j=this.h=this.g=null,this.g=new I(this.c,this.s),this.h=new I(this.c,this.s),this.j=new I(this.c,this.s),this.m=new I(this.c,this.s),t=E(t=new w(this.a.c+",serif",v(this.a))),this.g.a.style.cssText=t,t=E(t=new w(this.a.c+",sans-serif",v(this.a))),this.h.a.style.cssText=t,t=E(t=new w("serif",v(this.a))),this.j.a.style.cssText=t,t=E(t=new w("sans-serif",v(this.a))),this.m.a.style.cssText=t,_(this.g),_(this.h),_(this.j),_(this.m)}m.prototype.c=function(t){for(var e=[],s=0;s<arguments.length;s++)e.push(arguments[s].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},T.prototype.start=function(){var t=this.c.o.document,e=this,s=n(),o=new Promise((function(o,i){!function r(){n()-s>=e.f?i():t.fonts.load(function(t){return x(t)+" "+t.f+"00 300px "+b(t.c)}(e.a),e.h).then((function(t){1<=t.length?o():setTimeout(r,25)}),(function(){i()}))}()})),i=null,r=new Promise((function(t,s){i=setTimeout(s,e.f)}));Promise.race([r,o]).then((function(){i&&(clearTimeout(i),i=null),e.g(e.a)}),(function(){e.j(e.a)}))};var N={D:"serif",C:"sans-serif"},F=null;function L(){if(null===F){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);F=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))}return F}function W(t,e,s){for(var n in N)if(N.hasOwnProperty(n)&&e===t.f[N[n]]&&s===t.f[N[n]])return!0;return!1}function B(t){var e,o=t.g.a.offsetWidth,i=t.h.a.offsetWidth;(e=o===t.f.serif&&i===t.f["sans-serif"])||(e=L()&&W(t,o,i)),e?n()-t.A>=t.w?L()&&W(t,o,i)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?R(t,t.v):R(t,t.B):function(t){setTimeout(s((function(){B(this)}),t),50)}(t):R(t,t.v)}function R(t,e){setTimeout(s((function(){h(this.g.a),h(this.h.a),h(this.j.a),h(this.m.a),e(this.a)}),t),0)}function M(t,e,s){this.c=t,this.a=e,this.f=0,this.m=this.j=!1,this.s=s}O.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=n(),B(this)};var P=null;function D(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&c(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),k(t,"active")):A(t.a))}function Y(t){this.j=t,this.a=new q,this.h=0,this.f=this.g=!0}function U(t,e,n,o,i){var r=0==--t.h;(t.f||t.g)&&setTimeout((function(){var t=i||null,a=o||{};if(0===n.length&&r)A(e.a);else{e.f+=n.length,r&&(e.j=r);var h,l=[];for(h=0;h<n.length;h++){var u=n[h],d=a[u.c],f=e.a,p=u;if(f.g&&c(f.f,[f.a.c("wf",p.c,v(p).toString(),"loading")]),k(f,"fontloading",p),f=null,null===P)if(window.FontFace){p=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var g=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);P=p?42<parseInt(p[1],10):!g}else P=!1;f=P?new T(s(e.g,e),s(e.h,e),e.c,u,e.s,d):new O(s(e.g,e),s(e.h,e),e.c,u,e.s,t,d),l.push(f)}for(h=0;h<l.length;h++)l[h].start()}}),0)}function H(t,e){this.c=t,this.a=e}function z(t,e){this.c=t,this.a=e}function j(t,e){this.c=t||G,this.a=[],this.f=[],this.g=e||""}M.prototype.g=function(t){var e=this.a;e.g&&c(e.f,[e.a.c("wf",t.c,v(t).toString(),"active")],[e.a.c("wf",t.c,v(t).toString(),"loading"),e.a.c("wf",t.c,v(t).toString(),"inactive")]),k(e,"fontactive",t),this.m=!0,D(this)},M.prototype.h=function(t){var e=this.a;if(e.g){var s=l(e.f,e.a.c("wf",t.c,v(t).toString(),"active")),n=[],o=[e.a.c("wf",t.c,v(t).toString(),"loading")];s||n.push(e.a.c("wf",t.c,v(t).toString(),"inactive")),c(e.f,n,o)}k(e,"fontinactive",t),D(this)},Y.prototype.load=function(t){this.c=new o(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes,function(t,e,s){var n=[],o=s.timeout;!function(t){t.g&&c(t.f,[t.a.c("wf","loading")]),k(t,"loading")}(e),n=function(t,e,s){var n,o=[];for(n in e)if(e.hasOwnProperty(n)){var i=t.c[n];i&&o.push(i(e[n],s))}return o}(t.a,s,t.c);var i=new M(t.c,e,o);for(t.h=n.length,e=0,s=n.length;e<s;e++)n[e].load((function(e,s,n){U(t,i,e,s,n)}))}(this,new C(this.c,t),t)},H.prototype.load=function(t){function e(){if(i["__mti_fntLst"+n]){var s,o=i["__mti_fntLst"+n](),r=[];if(o)for(var a=0;a<o.length;a++){var h=o[a].fontfamily;null!=o[a].fontStyle&&null!=o[a].fontWeight?(s=o[a].fontStyle+o[a].fontWeight,r.push(new w(h,s))):r.push(new w(h))}t(r)}else setTimeout((function(){e()}),50)}var s=this,n=s.a.projectId,o=s.a.version;if(n){var i=s.c.o;d(this.c,(s.a.api||"https://fast.fonts.net/jsapi")+"/"+n+".js"+(o?"?v="+o:""),(function(o){o?t([]):(i["__MonotypeConfiguration__"+n]=function(){return s.a},e())})).id="__MonotypeAPIScript__"+n}else t([])},z.prototype.load=function(t){var e,s,n=this.a.urls||[],o=this.a.families||[],i=this.a.testStrings||{},r=new f;for(e=0,s=n.length;e<s;e++)u(this.c,n[e],p(r));var a=[];for(e=0,s=o.length;e<s;e++)if((n=o[e].split(":"))[1])for(var h=n[1].split(","),c=0;c<h.length;c+=1)a.push(new w(n[0],h[c]));else a.push(new w(n[0]));g(r,(function(){t(a,i)}))};var G="https://fonts.googleapis.com/css";function Q(t){this.f=t,this.a=[],this.c={}}var $={latin:"BESbswy","latin-ext":"",cyrillic:"",greek:"",khmer:"",Hanuman:""},V={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},K={i:"i",italic:"i",n:"n",normal:"n"},J=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function Z(t,e){this.c=t,this.a=e}var X={Arimo:!0,Cousine:!0,Tinos:!0};function tt(t,e){this.c=t,this.a=e}function et(t,e){this.c=t,this.f=e,this.a=[]}Z.prototype.load=function(t){var e=new f,s=this.c,n=new j(this.a.api,this.a.text),o=this.a.families;!function(t,e){for(var s=e.length,n=0;n<s;n++){var o=e[n].split(":");3==o.length&&t.f.push(o.pop());var i="";2==o.length&&""!=o[1]&&(i=":"),t.a.push(o.join(i))}}(n,o);var i=new Q(o);!function(t){for(var e=t.f.length,s=0;s<e;s++){var n=t.f[s].split(":"),o=n[0].replace(/\+/g," "),i=["n4"];if(2<=n.length){var r;if(r=[],a=n[1])for(var a,h=(a=a.split(",")).length,c=0;c<h;c++){var l;if((l=a[c]).match(/^[\w-]+$/))if(null==(u=J.exec(l.toLowerCase())))l="";else{if(l=null==(l=u[2])||""==l?"n":K[l],null==(u=u[1])||""==u)u="4";else var u=V[u]||(isNaN(u)?"4":u.substr(0,1));l=[l,u].join("")}else l="";l&&r.push(l)}0<r.length&&(i=r),3==n.length&&(r=[],0<(n=(n=n[2])?n.split(","):r).length&&(n=$[n[0]])&&(t.c[o]=n))}for(t.c[o]||(n=$[o])&&(t.c[o]=n),n=0;n<i.length;n+=1)t.a.push(new w(o,i[n]))}}(i),u(s,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,s=[],n=0;n<e;n++)s.push(t.a[n].replace(/ /g,"+"));return e=t.c+"?family="+s.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(n),p(e)),g(e,(function(){t(i.a,i.c,X)}))},tt.prototype.load=function(t){var e=this.a.id,s=this.c.o;e?d(this.c,(this.a.api||"https://use.typekit.net")+"/"+e+".js",(function(e){if(e)t([]);else if(s.Typekit&&s.Typekit.config&&s.Typekit.config.fn){e=s.Typekit.config.fn;for(var n=[],o=0;o<e.length;o+=2)for(var i=e[o],r=e[o+1],a=0;a<r.length;a++)n.push(new w(i,r[a]));try{s.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}t(n)}}),2e3):t([])},et.prototype.load=function(t){var e=this.f.id,s=this.c.o,n=this;e?(s.__webfontfontdeckmodule__||(s.__webfontfontdeckmodule__={}),s.__webfontfontdeckmodule__[e]=function(e,s){for(var o=0,i=s.fonts.length;o<i;++o){var r=s.fonts[o];n.a.push(new w(r.name,S("font-weight:"+r.weight+";font-style:"+r.style)))}t(n.a)},d(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(t){return t.o.location.hostname||t.a.location.hostname}(this.c)+"/"+e+".js",(function(e){e&&t([])}))):t([])};var st=new Y(window);st.a.c.custom=function(t,e){return new z(e,t)},st.a.c.fontdeck=function(t,e){return new et(e,t)},st.a.c.monotype=function(t,e){return new H(e,t)},st.a.c.typekit=function(t,e){return new tt(e,t)},st.a.c.google=function(t,e){return new Z(e,t)};var nt={load:s(st.load,st)};Nt.exports?Nt.exports=nt:(window.WebFont=nt,window.WebFontConfig&&st.load(window.WebFontConfig))}()),Ft.exports),Wt=Tt(Lt);const Bt=Phaser.Display.Canvas.CanvasPool;var Rt=function(t,e){var s=Bt.create(),n=s.getContext("2d",{willReadFrequently:!0}),o=`8px ${t}`;n.font=o;var i=Math.ceil(n.measureText(e).width),r=i,a=2*r;i===s.width&&a===s.height||(s.width=i,s.height=a),n.fillStyle="#000",n.fillRect(0,0,i,a),n.textBaseline="alphabetic",n.fillStyle="#fff",n.font=o,n.fillText(e,0,r);for(var h=n.getImageData(0,0,i,a).data,c=!1,l=0,u=h.length;l<u;l+=4)if(h[l]>0){c=!0;break}return Bt.remove(s),c};const Mt=Phaser.Loader.FILE_POPULATED,Pt=Phaser.Utils.Objects.GetValue;class Dt extends Phaser.Loader.File{load(){if(this.state===Mt)this.loader.nextFile(this,!0);else{var t=this.config;this.testString=Pt(t,"testString",void 0),void 0!==this.testString&&(this.testInterval=Pt(t,"testInterval",20),this.fontTests={},delete t.testString,delete t.testInterval),t.active=this.onLoad.bind(this),t.inactive=this.onError.bind(this),t.fontactive=this.onFontActive.bind(this),t.fontinactive=this.onFontInactive.bind(this),Wt.load(t)}}onLoad(){if(void 0===this.testString)this.loader.nextFile(this,!0);else{var t=function(){this.testFonts()?this.loader.nextFile(this,!0):setTimeout(t,this.testInterval)}.bind(this);t()}}onError(){this.loader.nextFile(this,!1)}onFontActive(t,e){var s;void 0!==this.testString&&void 0!==(s="string"==typeof this.testString?this.testString:this.testString[t])&&(this.fontTests[t]=s),this.loader.emit("webfontactive",this,t,e)}onFontInactive(t,e){this.loader.emit("webfontinactive",this,t,e)}testFonts(){var t=!0;for(var e in this.fontTests)Rt(e,this.fontTests[e])?delete this.fontTests[e]:t=!1;return t}}const Yt=Phaser.Utils.Objects.IsPlainObject,Ut=function(t,e){return Yt(t)?(e=t).hasOwnProperty("config")?(e.type="webfont",e.url=""):e={key:"webfont",type:"webfont",url:"",config:e}:e={type:"webfont",url:"",key:t,config:e},this.addFile(new Dt(this,e)),this};class Ht extends Phaser.Plugins.BasePlugin{constructor(t){super(t),t.registerFileType("rexWebFont",Ut)}addToScene(t){t.sys.load.rexWebFont=Ut}}class zt{constructor(t,e=-1){this.questionIndex=-1,this.selectedAnswerIndex=-1,this.question=t.question,this.answers=t.answers,this.correct=t.correct,this.questionIndex=t.questionIndex,this.selectedAnswerIndex=-1}}const jt={type:Phaser.AUTO,width:1920,height:1080,scale:{mode:Phaser.Scale.RESIZE},plugins:{global:[{key:"SocketManagerPlugin",plugin:Et,start:!1},{key:"rexWebFontLoader",plugin:Ht,start:!0}]},scene:class extends n{constructor(){super({key:"MoneyTree"}),this.moneyamounts=[1,2,5,10,25,50,75,100,200,500,1e3,2500,5e3,1e4,15e3,25e3,5e4,75e3,1e5,15e4,25e4],this.questions=[],this.questionData1=[{questionIndex:20,question:"In literature, what is the name of the ship in Moby-Dick?",answers:["Pequod","Essex","Resolute"],correct:0},{questionIndex:19,question:"Which philosopher wrote Being and Time?",answers:["Martin Heidegger","Friedrich Nietzsche","Jean-Paul Sartre"],correct:0},{questionIndex:18,question:'Which physicist first proposed the idea of quantum energy packets called "quanta"?',answers:["Albert Einstein","Max Planck","Niels Bohr"],correct:1},{questionIndex:17,question:"What is the rarest of these blood types in humans?",answers:["AB+","AB-","O"],correct:1},{questionIndex:16,question:"Which of these is a botanical berry?",answers:["Strawberry","Banana","Apple"],correct:1},{questionIndex:15,question:"What is the only country in the world whose flag is not rectangular or square?",answers:["Bhutan","Nepal","Vatican City"],correct:1},{questionIndex:14,question:"Which country was formerly known as Abyssinia?",answers:["Sudan","Ethiopia","Libya"],correct:1},{questionIndex:13,question:"What part of the brain is responsible for balance and coordination?",answers:["Cerbrum","Brainstem","Cerebellum"],correct:2},{questionIndex:12,question:"Which language is the most spoken in the world by native speakers?",answers:["Mandarin Chinese","English","Spanish"],correct:0},{questionIndex:11,question:"In what year was the first email sent?",answers:["1981","1971","1965"],correct:1},{questionIndex:10,question:"What is the capital city of Canada?",answers:["Toronto","Ottowa","Vancouver"],correct:1},{questionIndex:9,question:"Which ocean lies between Africa and Australia?",answers:["Pacific","Indian","Southern"],correct:1},{questionIndex:8,question:"In Greek mythology, who is the god of the underworld?",answers:["Apollo","Zeus","Hades"],correct:2},{questionIndex:7,question:"Which Shakespeare play features the characters Goneril, Regan, and Cordelia?",answers:["Hamlet","Macbeth","King Lear"],correct:2},{questionIndex:6,question:"Whats the smallest country in the world by land area?",answers:["Monaco","Vatican City","San Marino"],correct:1},{questionIndex:5,question:"Which metal has the chemical symbol Fe?",answers:["Iron","Silver","Lead"],correct:0},{questionIndex:4,question:"In which year did the Berlin Wall fall?",answers:["1991","1985","1989"],correct:2},{questionIndex:3,question:"What is the name of the longest bone in the human body?",answers:["Tibia","Femur","Humerus"],correct:1},{questionIndex:2,question:'In computing, what does "CPU" stand for?',answers:["Central Processing Unit","Central Power Unit","Computer Power Utility"],correct:0},{questionIndex:1,question:"How many legs does a spider have?",answers:["Six","Eight","Ten"],correct:1},{questionIndex:0,question:"Which planet is known as the Red Planet?",answers:["Mars","Venus","Jupiter"],correct:0}],this.questionData2=[{questionIndex:0,question:"Who was the 1st person in space?",answers:["Neil Armstrong","Gherman Titov","Yuri Gagarin"],correct:2},{questionIndex:1,question:"Whats the square root of 144?",answers:["10","12","20"],correct:1},{questionIndex:2,question:"A recipe calls for flour and sugar in the ratio 3:2. If you use 18 cups of flour, how much sugar should you use?",answers:["6 Cups","12 Cups","8 Cups"],correct:1},{questionIndex:3,question:"How many players are there in a Rugby Union team?",answers:["11","13","15"],correct:2},{questionIndex:4,question:"Whats the chemical symbol for Gold?",answers:["Ag","Au","Fe"],correct:1},{questionIndex:5,question:"What color is a Himalayan salt lamp typically?",answers:["Pink","White","Pale Blue"],correct:0},{questionIndex:6,question:"Who is the Greek god of the sea?",answers:["Atlas","Zeus","Poseiden"],correct:2},{questionIndex:7,question:"What is the Capital of Morocco?",answers:["Algiers","Tunis","Rabat"],correct:2},{questionIndex:8,question:"What team did Brian Clough manage to two European Cups in Football?",answers:["Nottingham Forest","Liverpool","Manchester United"],correct:0},{questionIndex:9,question:"Whats the longest river in Asia?",answers:["Mekong","Yantze","Ganges"],correct:1},{questionIndex:10,question:"Who wrote the novel Moby-Dick?",answers:["Mark Twain","Herman Melville","F.Scott Fitzgerald"],correct:1},{questionIndex:11,question:"Which video game franchise features Hyrule and the Master Sword?",answers:["Final Fantasy","The Legend of Zelda","Medal of Honour"],correct:1},{questionIndex:12,question:"What is the capital of Bhutan?",answers:["Thimphu","Kathmandu","Dhaka"],correct:0},{questionIndex:13,question:"What element has the atomic number 92?",answers:["Uranium","Plutonium","Thorium"],correct:0},{questionIndex:14,question:"Which author used the pen name Richard Bachman?",answers:["Stephen King","JK Rowling","Clive Barker"],correct:0},{questionIndex:15,question:"Which of these was a real programming language in the 1960s?",answers:["LISP","PYTHON","C++"],correct:0},{questionIndex:16,question:"What unit measures radiation dosage?",answers:["Tesla","Sievert","Pascal"],correct:1},{questionIndex:17,question:"Who painted The Garden of Earthly Delights?",answers:["Hieronymus Bosch","Pieter Bruegel the Elder","Albrecht Drer"],correct:0},{questionIndex:18,question:"What was the name of Horatio Nelsons ship at the Battle of the Nile in 1798?",answers:["HMS Vanguard","HMS Victory","HMS Terror"],correct:0},{questionIndex:19,question:"Which film won Best Picture at the 2020 Academy Awards?",answers:["1917","Nomadland","Parasite"],correct:2},{questionIndex:20,question:"Which artist holds the record for the longest-running No. 1 single on the Billboard Hot 100?",answers:["Mariah Carey","Lil Nas X","Katy Perry"],correct:1}],this.questionData3=[{questionIndex:0,question:"What is the boiling point of water in Celsius?",answers:["0C","100C","101C"],correct:1},{questionIndex:1,question:"Which is not a primary color?",answers:["Red","Green","Blue"],correct:1},{questionIndex:2,question:"Who painted the Mona Lisa?",answers:["Vincent van Gogh","Leonardo da Vinci","Michelangelo"],correct:1},{questionIndex:3,question:"What language is primarily spoken in Brazil?",answers:["Spanish","Portuguese","French"],correct:1},{questionIndex:4,question:"What is the currency of Thailand?",answers:["Yen","Baht","Rupee"],correct:1},{questionIndex:5,question:"Who is the author of The Hobbit?",answers:["George R.R. Martin","Lewis Caroll","J.R.R. Tolkien"],correct:2},{questionIndex:6,question:"Which continent has the most countries?",answers:["Asia","Europe","Africa"],correct:2},{questionIndex:7,question:"Which blood type is a universal donor?",answers:["O-","AB+","AB-"],correct:0},{questionIndex:8,question:"Which ocean is the largest?",answers:["Atlantic","Indian","Pacific"],correct:2},{questionIndex:9,question:"What is the longest river in Europe?",answers:["Danube","Volga","Rhine"],correct:1},{questionIndex:10,question:"How many bones are in the adult human body?",answers:["156","206","256"],correct:1},{questionIndex:11,question:"Who wrote the novel The Catcher in the Rye?",answers:["John Steinbeck","J.D. Salinger","Ernest Hemingway"],correct:1},{questionIndex:12,question:"Which battle marked the end of Napoleon's rule in 1815?",answers:["Austerlitz","Leipzig","Waterloo"],correct:2},{questionIndex:13,question:"What is the largest organ in the human body?",answers:["Skin","Liver","Heart"],correct:0},{questionIndex:14,question:"Which Nintendo character made his debut in the game Donkey Kong (1981)?",answers:["Pikachu","Mario","Sonic"],correct:1},{questionIndex:15,question:"What element has the highest electrical conductivity?",answers:["Copper","Gold","Silver"],correct:2},{questionIndex:16,question:"What political theory is Karl Popper known for critiquing?",answers:["Totalitarianism","Utopianism","Historicism"],correct:2},{questionIndex:17,question:"Which planet has the most moons?",answers:["Jupiter","Saturn","Neptune"],correct:1},{questionIndex:18,question:"What is an irrational number?",answers:["Cannot be a ratio of two integers","One that is imaginary","One that is undefined"],correct:0},{questionIndex:19,question:"Which Country has the most time zones?",answers:["France","Russia","USA"],correct:1},{questionIndex:20,question:'In formal logic, what does the symbol "" mean?',answers:["Logical negation","Semantic Entailment","Biconditional"],correct:1}],this.questionData4=[{questionIndex:20,question:"Which treaty ended the Thirty Years War in 1648?",answers:["Treaty of Utrecht","Treaty of Vienna","Peace of Westphalia"],correct:2},{questionIndex:19,question:"Which element has the atomic number 1?",answers:["Helium","Oxygen","Hydrogen"],correct:2},{questionIndex:18,question:"How many bones are there in the adult human body?",answers:["201","206","212"],correct:1},{questionIndex:17,question:"Which country was formerly known as Persia?",answers:["Iraq","Iran","Turkey"],correct:1},{questionIndex:16,question:"Which war ended with the Treaty of Versailles?",answers:["Napoleonic Wars","World War I","World War II"],correct:1},{questionIndex:15,question:"What is the capital of Canada?",answers:["Toronto","Montreal","Ottawa"],correct:2},{questionIndex:14,question:"What is the chemical symbol for gold?",answers:["Ag","Au","Pb"],correct:1},{questionIndex:13,question:"Which artist painted The Last Supper?",answers:["Michelangelo","Raphael","Leonardo da Vinci"],correct:2},{questionIndex:12,question:"Which organ in the human body produces insulin?",answers:["Liver","Kidney","Pancreas"],correct:2},{questionIndex:11,question:"Which country hosted the 2016 Summer Olympics?",answers:["China","United Kingdom","Brazil"],correct:2},{questionIndex:10,question:"Who was the first woman to win a Nobel Prize?",answers:["Jane Goodall","Rosalind Franklin","Marie Curie"],correct:2},{questionIndex:9,question:"What is the largest ocean on Earth?",answers:["Atlantic","Indian","Pacific"],correct:2},{questionIndex:8,question:"Who wrote Animal Farm?",answers:["Aldous Huxley","George Orwell","Ray Bradbury"],correct:1},{questionIndex:7,question:'Which element has the chemical symbol "Na"?',answers:["Nitrogen","Sodium","Neon"],correct:1},{questionIndex:6,question:"In which year did the Berlin Wall fall?",answers:["1987","1989","1991"],correct:1},{questionIndex:5,question:"Which mountain is the highest above sea level?",answers:["K2","Kangchenjunga","Mount Everest"],correct:2},{questionIndex:4,question:"Which scientist proposed the theory of general relativity?",answers:["Isaac Newton","Galileo Galilei","Albert Einstein"],correct:2},{questionIndex:3,question:"Which country uses the yen as its currency?",answers:["China","South Korea","Japan"],correct:2},{questionIndex:2,question:"Which gas makes up the largest percentage of Earth's atmosphere?",answers:["Oxygen","Carbon dioxide","Nitrogen"],correct:2},{questionIndex:1,question:'Which sport uses the term "love" for a score of zero?',answers:["Badminton","Squash","Tennis"],correct:2},{questionIndex:0,question:"What is the capital of Italy?",answers:["Milan","Venice","Rome"],correct:2}],this.questionData5=[{questionIndex:20,question:"Which mathematician proved Fermat's Last Theorem in 1994?",answers:["Pierre de Fermat","Grigori Perelman","Andrew Wiles"],correct:2},{questionIndex:19,question:"Who wrote Pale Fire?",answers:["Kingsley Amis","Vladimir Nabokov","John Fowles"],correct:1},{questionIndex:18,question:"Which chemical element has the symbol Sn?",answers:["Lead","Silicon","Tin"],correct:2},{questionIndex:17,question:"How many strings does a standard violin have?",answers:["Three","Four","Five"],correct:1},{questionIndex:16,question:"Which scientist developed the laws of motion?",answers:["Albert Einstein","Isaac Newton","Nikola Tesla"],correct:1},{questionIndex:15,question:"Which sea separates Europe and Africa?",answers:["Black Sea","Red Sea","Mediterranean Sea"],correct:2},{questionIndex:14,question:"Which country won the FIFA World Cup in 2018?",answers:["Croatia","Brazil","France"],correct:2},{questionIndex:13,question:"Which empire was ruled by Genghis Khan?",answers:["Ottoman Empire","Roman Empire","Mongol Empire"],correct:2},{questionIndex:12,question:"Who painted the ceiling of the Sistine Chapel?",answers:["Leonardo da Vinci","Raphael","Michelangelo"],correct:2},{questionIndex:11,question:"Which language has the most native speakers in Europe?",answers:["English","French","German"],correct:2},{questionIndex:10,question:"Which blood type is known as the universal donor?",answers:["A","B","O -"],correct:2},{questionIndex:9,question:"What is the smallest planet in our solar system?",answers:["Mars","Mercury","Venus"],correct:1},{questionIndex:8,question:"Which country gifted the Statue of Liberty to the United States?",answers:["United Kingdom","Germany","France"],correct:2},{questionIndex:7,question:"Who was the first President of the United States?",answers:["Thomas Jefferson","John Adams","George Washington"],correct:2},{questionIndex:6,question:"What is the capital of Norway?",answers:["Stockholm","Copenhagen","Oslo"],correct:2},{questionIndex:5,question:"Which planet is famous for its prominent ring system?",answers:["Jupiter","Uranus","Saturn"],correct:2},{questionIndex:4,question:"Which city is known as The Eternal City?",answers:["Athens","Jerusalem","Rome"],correct:2},{questionIndex:3,question:"What is the longest bone in the human body?",answers:["Tibia","Humerus","Femur"],correct:2},{questionIndex:2,question:"Which metal is liquid at room temperature?",answers:["Lead","Mercury","Aluminium"],correct:1},{questionIndex:1,question:"What is the square root of 144?",answers:["10","12","14"],correct:1},{questionIndex:0,question:"What is the main ingredient in traditional Japanese miso?",answers:["Rice","Soybeans","Seaweed"],correct:1}],this.questionData6=[{questionIndex:20,question:'Who wrote "The Lover" (L\'Amant)?',answers:["Simone de Beauvoir","Marguerite Duras","Annie Ernaux"],correct:1},{questionIndex:19,question:"What is the SI unit of electrical current?",answers:["Volt","Ampere","Watt"],correct:1},{questionIndex:18,question:"In which year did Constantinople fall to the Ottoman Empire?",answers:["1492","1453","1517"],correct:1},{questionIndex:17,question:"Which planet has the strongest gravitational pull?",answers:["Earth","Jupiter","Saturn"],correct:1},{questionIndex:16,question:"Which metal is traditionally used to make electrical wiring?",answers:["Iron","Copper","Aluminium"],correct:1},{questionIndex:15,question:"Which desert is the largest hot desert in the world?",answers:["Gobi","Sahara","Arabian"],correct:1},{questionIndex:14,question:"Which country has won the most FIFA World Cups?",answers:["Germany","Italy","Brazil"],correct:2},{questionIndex:13,question:"Which ancient civilisation built Machu Picchu?",answers:["Aztec","Inca","Maya"],correct:1},{questionIndex:12,question:"What is the currency of Switzerland?",answers:["Euro","Franc","Krone"],correct:1},{questionIndex:11,question:"Which ocean lies between Africa and Australia?",answers:["Atlantic","Indian","Pacific"],correct:1},{questionIndex:10,question:"Which painter is associated with the Cubist movement?",answers:["Salvador Dal","Pablo Picasso","Henri Matisse"],correct:1},{questionIndex:9,question:"Who developed the theory of evolution by natural selection?",answers:["Gregor Mendel","Charles Darwin","Louis Pasteur"],correct:1},{questionIndex:8,question:"What is the largest island in the world?",answers:["Greenland","Borneo","Madagascar"],correct:0},{questionIndex:7,question:"Which country was the first to grant women the right to vote?",answers:["United States","United Kingdom","New Zealand"],correct:2},{questionIndex:6,question:"Who wrote the novel '1984'?",answers:["George Orwell","Aldous Huxley","Ray Bradbury"],correct:0},{questionIndex:5,question:"Which element has the chemical symbol 'K'?",answers:["Potassium","Krypton","Calcium"],correct:0},{questionIndex:4,question:"Which city is home to the EU's main institutions?",answers:["Brussels","Strasbourg","Luxembourg"],correct:0},{questionIndex:3,question:"What is the largest internal organ in the human body?",answers:["Brain","Liver","Lungs"],correct:1},{questionIndex:2,question:"Which country has the longest coastline in the world?",answers:["Russia","Canada","Australia"],correct:1},{questionIndex:1,question:"What is the capital of South Korea?",answers:["Busan","Jakarta","Seoul"],correct:2},{questionIndex:0,question:"Who was the first human to travel into space?",answers:["Neil Armstrong","Yuri Gagarin","Buzz Aldrin"],correct:1}],this.allinQuestionData=[{question:"What is the hardest natural substance on Earth?",answers:["Correct","Incorrect"],correct:0,questionIndex:0,selectedAnswerIndex:-1},{question:"Which planet is closest to the sun?",answers:["Correct","Incorrect"],correct:0,questionIndex:1,selectedAnswerIndex:-1},{question:"In which year did the Titanic sink?",answers:["Correct","Incorrect"],correct:0,questionIndex:2,selectedAnswerIndex:-1},{question:"Who is known as the father of modern physics?",answers:["Correct","Incorrect"],correct:0,questionIndex:3,selectedAnswerIndex:-1},{question:'Which author wrote "If on a Winter\'s Night a Traveler?"',answers:["Correct","Incorrect"],correct:0,questionIndex:4,selectedAnswerIndex:-1},{question:'Who wrote "Things Fall Apart"?',answers:["Correct","Incorrect"],correct:0,questionIndex:5,selectedAnswerIndex:-1},{question:"Which chemical element has the highest melting point?",answers:["Correct","Incorrect"],correct:0,questionIndex:6,selectedAnswerIndex:-1}],this.transitions={SPLASH:[i.INTRO],INTRO:[i.CHOOSE_ENVELOPE],CHOOSE_ENVELOPE:[i.INTRO_ROUND,i.END_ROUND],INTRO_ROUND:[i.QUESTION],QUESTION:[i.ANSWER],ANSWER:[i.QUESTION,i.END_ROUND],END_ROUND:[i.FINAL_CHOICE],FINAL_CHOICE:[i.PLAY_SAFE,i.GAMBLE,i.ALLIN],PLAY_SAFE:[i.END_QUIZ],CHECK_ENVELOPE:[i.END_QUIZ],GAMBLE:[i.GAMBLE_WON,i.GAMBLE_LOST],GAMBLE_WON:[i.END_QUIZ],GAMBLE_LOST:[i.END_QUIZ],ALLIN:[i.ALLIN_WON,i.ALLIN_LOST],ALLIN_WON:[i.END_QUIZ],ALLIN_LOST:[i.END_QUIZ],END_QUIZ:[i.SAVE_RESULTS],SAVE_RESULTS:[i.SPLASH],DEBUG:[i.DEBUG]},this.stateActions={SPLASH:()=>this.splash(),INTRO:()=>this.introQuiz(),CHOOSE_ENVELOPE:()=>this.chooseEnvelope(),INTRO_ROUND:()=>this.introRound(),QUESTION:()=>this.nextQuestion(),ANSWER:()=>this.showAnswer(),END_ROUND:()=>this.endRound(),FINAL_CHOICE:()=>this.finalChoice(),PLAY_SAFE:()=>this.playSafe(),CHECK_ENVELOPE:()=>this.checkEnvelope(),GAMBLE:()=>this.gamble(),GAMBLE_WON:()=>this.gambleWon(),GAMBLE_LOST:()=>this.gambleLost(),ALLIN:()=>this.allin(),ALLIN_WON:()=>this.allinWon(),ALLIN_LOST:()=>this.allinLost(),END_QUIZ:()=>this.endQuiz(),SAVE_RESULTS:()=>this.saveResults(),DEBUG:()=>this.debug()},this.envelopes=[],this.safeCash=0,this.allinCash=0}init(){console.log("MoneyTree.init: hello:"),super.init(),this.FSM=new o(i.SPLASH,this.transitions,this.stateActions)}preload(){this.load.image("borderbox","assets/rounded-rect-gold-black-200x80x12.png"),this.load.image("playernamepanel","assets/rounded-rect-paleblue-320x32x8.png"),this.load.image("envelope","assets/moneytree-envelope.png"),this.load.image("studio","assets/thetower-studio.jpg"),this.load.image("splash","assets/thetower-splash.jpg"),this.load.audio("lowtick",["assets/audio/moneytree-tick.mp3"]),this.load.audio("hightick",["assets/audio/moneytree-hightick.mp3"]),this.load.audio("answercorrect",["assets/audio/moneytree-answercorrect.wav"]),this.load.audio("answerincorrect",["assets/audio/moneytree-answerincorrect.wav"]),this.load.audio("envelopeopen",["assets/audio/moneytree-envelopeopen.mp3"]),this.load.audio("envelopeshuffle",["assets/audio/moneytree-envelopeshuffle.mp3"]),this.load.audio("highlightslot",["assets/audio/moneytree-highlightslot.mp3"]),this.load.rexWebFont({google:{families:["Titan One"]}})}create(){console.log("Phaser.create::",this.game.renderer.type===Phaser.WEBGL?"WebGL":"Canvas"),this.stateDebugger=new r(this,this.FSM,(t=>this.mockState(t))),this.input.keyboard&&this.input.keyboard.on("keydown-D",(t=>{t.ctrlKey&&t.altKey&&this.stateDebugger.toggle()})),this.labelConfig={fontFamily:"Arial",fontSize:60,color:"#cccc00",backgroundColor:"#000000",padding:{left:20,right:20,top:this.getY(8),bottom:this.getY(8)}},this.FSM.start()}debug(){console.log("Debug: general purpose debug entry point...")}mockState(t){switch(console.log("mockState:",t),console.log(this.questions),t){case i.ANSWER:this.currentQuestion=this.questions[0],this.currentQuestion.selectedAnswerIndex=0;break;case i.END_ROUND:this.envelopeContainer.x=3e3;break;case i.END_QUIZ:this.envelopeContainer.x=3e3,this.currentQuestion=this.questions[0]}}splash(){console.log("splash: hello:");const t=this.add.image(0,0,"splash");console.log("Image:",t.displayWidth,t.displayHeight,t.scaleX,t.scaleY,t.width,t.height),t.scaleX=1920/t.width,t.scaleY=this.getY(1080)/t.height,t.setOrigin(0,0);const e=this.add.graphics();e.fillStyle(0,.4),e.fillRect(0,0,1920,this.getY(1080));const s=[this.questionData1,this.questionData2,this.questionData3,this.questionData4,this.questionData5,this.questionData6],n=this.add.container();for(let t=0;t<6;t++){const e=this.add.text(480+t%3*480,this.getY(120)+Math.floor(t/3)*this.getY(100),`Game ${t+1}`,{fontFamily:"Arial",color:"#000090",backgroundColor:"#000000",stroke:"#FFFFFF",strokeThickness:4,padding:{left:30,right:30,top:this.getY(20),bottom:this.getY(20)}}).setOrigin(.5).setFontSize(this.getY(48)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{a(t)})).on("pointerover",(()=>{e.setBackgroundColor("#333333")})).on("pointerout",(()=>e.setBackgroundColor("#000000")));n.add(e)}const o=this.add.text(960,this.getY(880),"An Iconic set that will get everyone talking",{fontFamily:"Titan One",fontSize:this.getY(60),color:"#ddddff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setStroke("#000000",2),r=this.add.text(960,this.getY(960),"A gameshow mechanism that will get everyone watching!",{fontFamily:"Titan One",fontSize:this.getY(60),color:"#ddddff",stroke:"#000000",strokeThickness:3,padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setStroke("#000000",2);n.add([o,r]);const a=t=>{this.questionData=s[t],this.allinQuestion=this.allinQuestionData[t],e.fillStyle(0,.8),e.fillRect(0,0,1920,this.getY(1080)),this.FSM.transitionTo(i.INTRO)};this.FSM.onNextStateChange((()=>{n.destroy(!0)}))}setupDisplay(){const t=this.add.image(0,0,"studio");console.log("Image:",t.displayWidth,t.displayHeight,t.scaleX,t.scaleY,t.width,t.height),t.scaleX=1920/t.width,t.scaleY=this.getY(1080)/t.height,t.setOrigin(0,0);const e=this.add.graphics();e.fillStyle(0,.4),e.fillRect(0,0,1920,this.getY(1080)),this.questionNumbersTree=new c(this,Array.from({length:21},((t,e)=>""+(21-e))),80,this.getY(1020),this.getY(100)),this.moneyAmountsTree=new c(this,this.moneyamounts.map((t=>`$ ${t}`)),240,this.getY(1020),this.getY(100)),this.add.existing(this.questionNumbersTree),this.add.existing(this.moneyAmountsTree),this.questionNumbersTree.updateSlots("#000000","#ffffff","#000000"),this.envelopeContainer=this.add.container(400,0).setDepth(10),this.correctAnswerContainer=this.add.container(360,0),this.incorrectAnswerContainer=this.add.container(2e3,0).setDepth(1);const s=this.getY(920)/20,n=s/141;this.envelopes=[];for(let t=0;t<this.questionData.length;t++){const e=this.add.sprite(0,this.getY(100)+t*s,"envelope");e.setData("ID",t),e.setScale(n),this.envelopes.push(e),this.envelopeContainer.add(e)}}introQuiz(){Phaser.Utils.Array.Shuffle(this.questionData),this.questions=this.questionData.map(((t,e)=>new zt(t,e))),this.setupDisplay(),console.log("introQuiz this:",this.questions);const t=this.add.container(),e=this.add.text(1280,this.getY(100),"How to Play",{fontFamily:"Arial",fontSize:"72px",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setStroke("#000000",2),s=this.add.text(720,this.getY(200),"We asked one hundred people to answer 21 questions\n\nWe then ranked the questions difficulty based on their answers\n\nThe questions were then assigned a monetary value\n\n$1 for the easiest question, all the way up to $250,000 for the hardest\n\nFinally, we placed each question into its own unmarked envelope",{fontFamily:"Arial",fontSize:"42px",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(0,0);s.setWordWrapWidth(1100);const n=this.add.text(1280,s.y+s.height+this.getY(120),"Continue",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:this.getY(10),bottom:this.getY(10)}}).setOrigin(.5).setFontSize(this.getY(48)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.sound.play("envelopeshuffle",{volume:.5}),this.FSM.transitionTo(i.CHOOSE_ENVELOPE)})).on("pointerover",(()=>n.setBackgroundColor("#0000ff"))).on("pointerout",(()=>n.setBackgroundColor("#000080")));t.add([e,s,n]),this.FSM.onNextStateChange((()=>{t.destroy(!0)}))}chooseEnvelope(){console.log("MoneyTree:: chooseEnvelope...");const t=this.add.container(),e=this.add.text(1280,this.getY(100),"ROUND 1:",{fontFamily:"Arial",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(72)),s=this.add.text(600,this.getY(200),"Choose a random envelope\n\nThis will be your envelope for the final round\n\nIt could be worth $250,000!\n\nClick on your envelope now",{fontFamily:"Arial",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(0,0).setFontSize(this.getY(32));s.setWordWrapWidth(1220),t.add([e,s]),this.FSM.onNextStateChange((()=>{t.destroy(!0)})),this.envelopes.forEach((t=>{t.setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{console.log("Envelope clicked:",t.getData("ID")),this.finalQuestion=this.questions[t.getData("ID")],this.finalEnvelope=t,t.off("pointerdown"),t.disableInteractive();const e=this.envelopeContainer.getWorldTransformMatrix(),s=e.tx+t.x*e.a+t.y*e.c,n=e.ty+t.x*e.b+t.y*e.d;this.envelopeContainer.remove(t),t.setPosition(s,n),this.tweens.add({targets:t,x:80,y:this.getY(48),duration:600,ease:"Sine.easeInOut",onComplete:()=>{this.FSM.transitionTo(i.INTRO_ROUND)}})})).on("pointerover",(()=>t.setTint(16711680))).on("pointerout",(()=>t.clearTint()))})),this.shuffleAndArrangeEnvelopes(5)}shuffleAndArrangeEnvelopes(t){const e=this.getY(840);console.log("shuffleAndArrangeEnvelopes:",t,1360,e),this.tweens.add({targets:this.envelopeContainer,x:1360,duration:500,ease:"Sine.easeInOut"});const s=this.envelopeContainer.list;let n=s.length;s.forEach((s=>{const o=Phaser.Math.FloatBetween(0,2*Math.PI),i=Phaser.Math.Between(150,350),r=Math.cos(o)*i,a=e+Math.sin(o)*i;this.tweens.add({targets:s,x:r,y:a,duration:400,ease:"Sine.easeInOut",onComplete:()=>{n--,0===n&&(t>0?this.shuffleAndArrangeEnvelopes(t-1):this.arrangeEnvelopesNeatly())}})}))}arrangeEnvelopesNeatly(){const t=this.getY(540),e=this.getY(300),s=this.envelopeContainer.list,n=s.length;if(0===s.length)return console.log("No envelopes to arrange! Current state:",this.FSM.getState()),void this.FSM.transitionTo(i.END_ROUND);this.tweens.add({targets:this.envelopeContainer,x:1320,duration:300,ease:"Sine.easeInOut"}),s.forEach(((s,o)=>{const i=o/n*Phaser.Math.PI2,r=300*Math.cos(i),a=t+Math.sin(i)*e;this.tweens.add({targets:s,x:r,y:a,duration:300})})),this.time.delayedCall(300,(()=>{this.rotateEnvelopesInCircle(0,t,e,2e4)}))}rotateEnvelopesInCircle(t,e,s,n=1e4){const o=this.envelopeContainer.list,i=o.length;o.forEach(((t,e)=>{t.setData("angle",e/i*Phaser.Math.PI2)})),this.tweens.addCounter({from:0,to:Phaser.Math.PI2,duration:n,repeat:-1,onUpdate:n=>{const i=n.getValue();o.forEach((n=>{const o=n.getData("angle")+i,r=t+Math.cos(o)*s,a=e+Math.sin(o)*s;n.setPosition(r,a)}))}})}introRound(){console.log("MoneyTree:: startRound..."),this.tweens.killTweensOf(this.envelopeContainer),this.tweens.add({targets:this.envelopeContainer,x:3840,duration:600,ease:"Sine.easeIn"});const t=this.add.container(),e=this.add.text(1280,this.getY(100),"ROUND 2:",{fontFamily:"Arial",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(72)),s=this.add.text(600,this.getY(200),"Now well start helping you figure out whats in your final envelope!\n\nIn Round 2, youll answer the remaining 20 questions. If you answer correctly:\n\n\tWe reveal that questions monetary value\n\tYou eliminate that amount from being a possible value of your final envelope\n\tYou win cash based on how many of the 100 contestants also answered correctly\n\nIf you answer incorrectly, you receive no information to aid you in the final",{fontFamily:"Arial",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(0,0).setFontSize(this.getY(32));s.setWordWrapWidth(1220);const n=this.add.text(1280,s.y+s.height+this.getY(120),"Continue",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:this.getY(10),bottom:this.getY(10)}}).setOrigin(.5).setFontSize(this.getY(48)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{t.destroy(!0),this.activateAllEnvelopes()})).on("pointerover",(()=>n.setBackgroundColor("#0000ff"))).on("pointerout",(()=>n.setBackgroundColor("#000080")));t.add([e,s,n]),this.safeCashText=this.add.text(1880,this.getY(1020),"CASH: $",this.labelConfig).setOrigin(1,.5).setVisible(!1)}nextQuestion(){console.log("MoneyTree:: nextQuestion..."),console.log("Current question:",this.currentQuestion),this.envelopeContainer.list.forEach((t=>{t.disableInteractive(),t.off("pointerdown")})),this.tweens.add({targets:this.envelopeContainer,x:3840,duration:600,ease:"Sine.easeIn",onComplete:()=>{this.showQuestion(this.currentQuestion)}})}showQuestion(t){console.log("MoneyTree:: showQuestion:",t),this.sound.play("envelopeopen",{volume:.5});const e=this.add.container(1200,0),s=this.getY(100),n=this.getY(300),o=this.make.nineslice({x:0,y:s,key:"borderbox",width:1200,height:n,leftWidth:12,rightWidth:12,topHeight:12,bottomHeight:12,origin:{x:.5,y:0},add:!0}),r=this.add.text(0,s+n/2,t.question);r.setFontFamily("Arial").setFontSize(this.getY(40)).setColor("#ffffcc").setWordWrapWidth(1120).setOrigin(.5),e.add([o,r]);const a=s+n+this.getY(120);t.answers.forEach(((t,s)=>{const n=this.add.text(0,a+this.getY(100*s),t,{fontFamily:"Arial",color:"#ffffff",padding:{left:40,right:40,top:this.getY(10),bottom:this.getY(10)}}).setOrigin(.5).setFontSize(this.getY(40)).setBackgroundColor("#5555a0").setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.currentQuestion.selectedAnswerIndex=s,h(s)})).on("pointerover",(()=>n.setBackgroundColor("#8888FF"))).on("pointerout",(()=>n.setBackgroundColor("#5555a0")));e.add(n)}));const h=e=>{const s=e===t.correct;r.text=s?"Correct!":"Incorrect :(",r.setColor(s?"#00ff00":"#ff0000"),r.setFontSize(this.getY(48)),s?this.sound.play("answercorrect",{volume:.5}):this.sound.play("answerincorrect",{volume:.5}),this.time.delayedCall(1e3,(()=>{this.FSM.getState()===i.GAMBLE?this.FSM.transitionTo(s?i.GAMBLE_WON:i.GAMBLE_LOST):this.FSM.getState()===i.ALLIN?this.FSM.transitionTo(s?i.ALLIN_WON:i.ALLIN_LOST):this.FSM.transitionTo(i.ANSWER)}))};this.FSM.onNextStateChange((()=>{e.destroy(!0)}))}showAnswer(){console.log("MoneyTree:: handleAnswer:",this.currentQuestion);const t=this.add.text(0,-100,this.currentQuestion.question).setFontFamily("Arial").setBackgroundColor("#111111").setColor("#bbbbbb").setPadding({left:40,right:40,top:this.getY(3),bottom:this.getY(3)}).setOrigin(0,.5).setFontSize(this.getY(32));this.currentQuestion.selectedAnswerIndex===this.currentQuestion.correct?this.moneyAmountsTree.animateCorrectAnswer(this.currentQuestion.questionIndex,(()=>{this.questionNumbersTree.setSlotState(this.currentQuestion.questionIndex,"revealed"),this.moneyAmountsTree.setSlotState(this.currentQuestion.questionIndex,"revealed");const e=this.questionNumbersTree.getSlotByIndex(this.currentQuestion.questionIndex).y;this.correctAnswerContainer.add(t),t.setPosition(0,e);const s=this.safeCash+75*(this.currentQuestion.questionIndex+1);this.tweens.add({targets:{value:this.safeCash},value:s,duration:1500,ease:"Linear",onUpdate:t=>{const e=t.getValue();this.safeCash=Math.round(e||0),this.safeCashText.setText(`CASH: $ ${this.safeCash}`).setVisible(!0)},onComplete:()=>{console.log("Cash tween complete:",this.safeCash)}}),this.allinCash=this.allinCash+this.moneyamounts[this.currentQuestion.questionIndex],this.activateAllEnvelopes()})):(this.incorrectAnswerContainer.add(t),this.arrangeIncorrectAnswers(),this.activateAllEnvelopes())}activateAllEnvelopes(){this.arrangeEnvelopesNeatly(),this.envelopeContainer.list.forEach((t=>{t.removeAllListeners(),t.setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{console.log("Envelope clicked:",t.getData("ID")),this.currentQuestion=this.questions[t.getData("ID")],this.envelopeContainer.remove(t),t.off("pointerdown"),t.destroy(),this.FSM.transitionTo(i.QUESTION)})).on("pointerover",(()=>t.setTint(16711680))).on("pointerout",(()=>t.clearTint()))}))}endRound(){console.log("MoneyTree:: END_ROUND"),this.correctAnswerContainer.y=this.getY(2e3);const t=this.add.container(),e=this.add.text(1280,this.getY(100),"YOUR FINAL CHOICE...",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(60)),s=this.add.text(600,this.getY(200),"Congratulations - you have made it to the end! Almost...\n\nYou have one final choice to make\n\nDo you want to KEEP the cash youve won so far?\nOr GAMBLE it all by opening your 'Final' envelope and hopefully winning a greater prize?\nOr go ALL-IN and attempt to walk away with the JACKPOT?\n\nIf you PLAY SAFE you walk away with your cash\nIf you GAMBLE you take home what's in the envelope\nIf you go ALL-IN you could win the value of all the questions you answered correctly\n\nYou can review all your wrong answers to try and work out whats in the envelope\n\n",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:60,right:60,top:this.getY(20),bottom:this.getY(20)}}).setOrigin(0,0).setFontSize(this.getY(32)).setWordWrapWidth(1220),n=this.add.text(1280,s.y+s.height+this.getY(60),"I'M READY",{fontFamily:"Arial",fontSize:"48px",color:"#ffffff",backgroundColor:"#5555a0",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(i.FINAL_CHOICE)})).on("pointerover",(()=>n.setBackgroundColor("#8888FF"))).on("pointerout",(()=>n.setBackgroundColor("#5555a0"))),o=this.add.text(600,n.y+this.getY(60),"* we know you're not playing for money right now, but please try to make your choice based on what you think you really would do! Thanks :)").setOrigin(0,0).setFontSize(this.getY(32)).setWordWrapWidth(1220);t.add([e,s,n,o]),this.FSM.onNextStateChange((()=>{this.correctAnswerContainer.y=0,t.destroy(!0)}))}finalChoice(){console.log("MoneyTree:: Final Choice..."),console.log(this.moneyAmountsTree.getAllSlots()),this.currentQuestion=this.finalQuestion;const t=this.add.container().setDepth(10),e=this.add.text(1280,this.getY(100),"YOUR FINAL CHOICE...",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(60)).setVisible(!1),s=this.add.text(600,this.getY(200),"* we know you're not playing for money right now, but please try to make your choice based on what you think you really would do! Thanks :)",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(0,0).setFontSize(this.getY(32)).setWordWrapWidth(1260).setVisible(!1),n=Math.min(s.y+s.height+this.getY(280),this.getY(840)),o=this.add.text(600,n,"SAFE",{fontFamily:"Arial",color:"#000000",backgroundColor:"#a0a000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(72)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(i.PLAY_SAFE)})).on("pointerover",(()=>o.setBackgroundColor("#ffff00"))).on("pointerout",(()=>o.setBackgroundColor("#a0a000")));this.tweens.add({targets:this.safeCashText,x:600,y:o.y+this.getY(120),duration:500}),this.safeCashText.text=`$ ${this.safeCash}`,this.safeCashText.setOrigin(.5,.5);const r=this.add.text(1100,n,"GAMBLE",{fontFamily:"Arial",color:"#000000",backgroundColor:"#a00000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(72)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(i.GAMBLE)})).on("pointerover",(()=>r.setBackgroundColor("#ff0000"))).on("pointerout",(()=>r.setBackgroundColor("#a00000")));this.tweens.add({targets:this.finalEnvelope,x:r.x,y:r.y+this.getY(120),duration:500});const a=this.getY(60)/133;this.finalEnvelope.setScale(a);const h=this.add.text(1600,n,"ALL-IN",{fontFamily:"Arial",color:"#FFFFFF",backgroundColor:"#0000A0",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(72)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(i.ALLIN)})).on("pointerover",(()=>h.setBackgroundColor("#0000FF"))).on("pointerout",(()=>h.setBackgroundColor("#0000A0"))),c=Object.assign({},this.labelConfig,{color:"#0000FF"});this.allinCashText=this.add.text(1600,o.y+this.getY(120),"$ 0",c).setOrigin(.5,.5).setVisible(!0);let l=0;this.tweens.add({targets:{value:l},value:this.allinCash,duration:1500,ease:"Linear",onUpdate:t=>{const e=t.getValue();l=Math.round(e||0),this.allinCashText.setText(`$ ${l}`).setVisible(!0)},onComplete:()=>{console.log("All In cash tween complete:",this.allinCash)}}),t.add([e,s,o,r,this.safeCashText,this.finalEnvelope,h,this.allinCashText]),this.FSM.onNextStateChange((()=>{this.incorrectAnswerContainer.setX(2e3),t.destroy(!0)}))}playSafe(){console.log("MoneyTree:: playSafe..."),this.finalDecision="SAFE";const t=this.add.container(),e=this.add.text(1280,this.getY(100),"PLAY SAFE!",{fontFamily:"Arial",fontSize:"72px",color:"#ffffff",backgroundColor:"#000000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setStroke("#000000",2),s=this.add.text(720,this.getY(200),`You played safe and walked away with $${this.safeCash} !\n\nLet's take a look at what you might have won...`,{fontFamily:"Arial",fontSize:"42px",color:"#ffffff",backgroundColor:"#000000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(0,0).setStroke("#000000",2);s.setWordWrapWidth(1100),t.add([e,s]),this.FSM.onNextStateChange((()=>{t.destroy(!0)})),this.moneyAmountsTree.animateCorrectAnswer(this.currentQuestion.questionIndex,(()=>{console.log("MoneyTree:: playSafe - animation complete..."),this.FSM.transitionTo(i.END_QUIZ)}))}checkEnvelope(){console.log("MoneyTree:: checkEnvelope..."),this.moneyAmountsTree.animateCorrectAnswer(this.currentQuestion.questionIndex,(()=>{console.log("MoneyTree:: checkEnvelope - animation complete..."),this.FSM.transitionTo(i.END_QUIZ)}))}gamble(){console.log("MoneyTree:: gamble..."),this.finalDecision="GAMBLE",this.FSM.transitionTo(i.GAMBLE_WON)}gambleWon(){this.finalDecision="GAMBLE - WON",this.moneyAmountsTree.animateCorrectAnswer(this.currentQuestion.questionIndex,(()=>{this.gambleWonMessage()}))}gambleWonMessage(){const t=this.currentQuestion.questionIndex,e=this.moneyamounts[t];console.log("MoneyTree:: gambleWon...:",t,e);const s=this.add.container().setDepth(10),n=this.add.text(1280,this.getY(100),"",{fontFamily:"Arial",fontSize:"72px",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(.5).setStroke("#000000",2),o=this.add.text(720,this.getY(160),"",{fontFamily:"Arial",fontSize:"42px",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(0,0).setWordWrapWidth(1100);e>2*this.safeCash?(n.setText("WOW!"),o.setText(`You took the gamble and you've won $${e}!\n\nIf you had played safe you would have walked away with $${this.safeCash}\n\nGreat result! Well played :)`)):e>this.safeCash?(n.setText("GOOD CHOICE!"),o.setText(`You took the gamble and you've won $${e}!\n\nYou could have played safe and only walked away with $${this.safeCash} but you made the right choice!`)):(n.setText("OUCH :("),o.setText(`You took the gamble and you've won $${e}!\n\nYou could have played safe and walked away with $${this.safeCash}...:(\n\nOh well - better luck next time!`));const r=this.add.text(1280,o.y+o.height+this.getY(160),"OK",{fontFamily:"Arial",fontSize:"48px",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(i.END_QUIZ)})).on("pointerover",(()=>r.setBackgroundColor("#0000ff"))).on("pointerout",(()=>r.setBackgroundColor("#000080")));s.add([n,o,r]),this.FSM.onNextStateChange((()=>{s.destroy(!0)}))}gambleLost(){console.log("MoneyTree:: gambleLost..."),this.finalDecision="GAMBLE - LOST";const t=this.currentQuestion.questionIndex;this.moneyamounts[t];const e=this.add.container().setDepth(10),s=this.add.text(1280,this.getY(100),"",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(.5).setFontSize(this.getY(72)),n=this.add.text(720,this.getY(200),"",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:60,right:60,top:this.getY(10),bottom:this.getY(10)}}).setOrigin(0,0).setFontSize(this.getY(42));n.setWordWrapWidth(1100),s.setText("OH DEAR..."),n.setText("You took the gamble and lost out on your BIG money prize... :(\n\nLet's see how much you would have won..."),e.add([s,n]),this.moneyAmountsTree.animateCorrectAnswer(t,(()=>{this.FSM.transitionTo(i.END_QUIZ)})),this.FSM.onNextStateChange((()=>{e.destroy(!0)}))}allin(){console.log("MoneyTree:: allin..."),this.finalDecision="ALL IN",this.envelopeContainer.list.forEach((t=>{t.disableInteractive(),t.off("pointerdown")})),this.tweens.add({targets:this.envelopeContainer,x:3840,duration:600,ease:"Sine.easeIn",onComplete:()=>{this.showQuestion(this.allinQuestion)}})}allinWon(){console.log("MoneyTree:: allinWon..."),this.finalDecision="ALL IN - WON",console.log("MoneyTree:: AllInWon...:",this.allinCash);const t=this.add.container().setDepth(10),e=this.add.text(1280,this.getY(100),"",{fontFamily:"Arial",fontSize:"72px",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(.5).setStroke("#000000",2),s=this.add.text(720,this.getY(160),"",{fontFamily:"Arial",fontSize:"42px",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(0,0).setWordWrapWidth(1100);e.setText("WOW!"),s.setText(`You took the ultimate ALL-IN gamble and you've won $${this.allinCash}!\n\nIf you had played safe you would have walked away with $${this.safeCash}\n\nGreat result! Well played :)`);const n=this.add.text(1280,s.y+s.height+this.getY(160),"OK",{fontFamily:"Arial",fontSize:"48px",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(i.END_QUIZ)})).on("pointerover",(()=>n.setBackgroundColor("#0000ff"))).on("pointerout",(()=>n.setBackgroundColor("#000080")));t.add([e,s,n]),this.FSM.onNextStateChange((()=>{t.destroy(!0)}))}allinLost(){console.log("MoneyTree:: allinLost..."),this.finalDecision="ALL IN - LOST";const t=this.add.container().setDepth(10),e=this.add.text(1280,this.getY(100),"",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(.5).setFontSize(this.getY(72)),s=this.add.text(720,this.getY(200),"",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:60,right:60,top:this.getY(10),bottom:this.getY(10)}}).setOrigin(0,0).setFontSize(this.getY(42));s.setWordWrapWidth(1100),e.setText("OH DEAR..."),s.setText("You took the ultimate ALL-IN gamble and lost out on the BIG money prize... :(\n\nLets see what you would have won if you'd chosen the envelope");const n=this.currentQuestion.questionIndex;this.moneyAmountsTree.animateCorrectAnswer(n,(()=>{this.FSM.transitionTo(i.END_QUIZ)})),t.add([e,s]),this.FSM.onNextStateChange((()=>{t.destroy(!0)}))}endQuiz(){console.log("MoneyTree:: endQuiz...");const t=this.currentQuestion.questionIndex,e=this.moneyamounts[t];this.correctAnswerContainer.x=2e3,console.log(this.questions),console.log("Final decision:",this.finalDecision),console.log("Safe cash amount:",this.safeCash),console.log("Gamble amount:",e);const s=this.add.container().setDepth(10),n=this.add.text(1280,this.getY(100),"Thanks for playing!",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(.5).setFontSize(this.getY(60)),o=this.add.text(720,this.getY(160),"",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(0,0).setFontSize(this.getY(40));o.setWordWrapWidth(1100),"SAFE"==this.finalDecision?o.setText("One last question: looking at the money tree, how low would the SAFE cash amount have needed to be for you to choose to GAMBLE?"):o.setText("One last question: looking at the money tree, how high would the SAFE cash amount have needed to be for you to choose to PLAY SAFE?");const r=720,a=o.y+o.height+this.getY(64),h=1100,c=r+this.safeCash/5e4*h,l=this.add.text(c,a+this.getY(64),`$ ${this.safeCash}`).setOrigin(.5).setFontSize(this.getY(32)).setFontFamily("Arial"),u=this.make.nineslice({x:r,y:a,key:"borderbox",width:h,height:24,leftWidth:12,rightWidth:12,topHeight:12,bottomHeight:12,origin:{x:0,y:.5},add:!0}),d=this.make.nineslice({x:c,y:a,key:"borderbox",width:24,height:64,leftWidth:12,rightWidth:12,topHeight:12,bottomHeight:12,origin:{x:.5,y:.5},add:!0});d.setInteractive(new Phaser.Geom.Rectangle(0,0,24,64),Phaser.Geom.Rectangle.Contains),this.input.setDraggable(d);var f=this.safeCash;this.input.on("drag",((t,e,s)=>{if(e===d){const t=Phaser.Math.Clamp(s,r,1820),e=(t-r)/h;f=5e4*Math.round(100*e)/100,l.setText(`$ ${f}`),l.x=t,d.x=t}}));const p=this.add.text(1280,o.y+o.height+this.getY(360),"OK",{fontFamily:"Arial",fontSize:"48px",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.thresholdAmount=f,this.FSM.transitionTo(i.SAVE_RESULTS)})).on("pointerover",(()=>p.setBackgroundColor("#0000ff"))).on("pointerout",(()=>p.setBackgroundColor("#000080")));s.add([n,o,p,l,u,d]),this.FSM.onNextStateChange((()=>{s.destroy(!0)}))}saveResults(){const t=this.currentQuestion.questionIndex,e=this.moneyamounts[t];console.log(this.questions);var s=this.questions.filter((t=>-1!==t.selectedAnswerIndex)).length,n=this.questions.filter((t=>t.selectedAnswerIndex==t.correct)).length;"SAFE"==this.finalDecision||(s-=1,"GAMBLE - WON"==this.finalDecision&&(n-=1));const o=[...this.questions].sort(((t,e)=>t.questionIndex-e.questionIndex));let r="";o.forEach((t=>{t.questionIndex===this.finalQuestion.questionIndex?r+="G":t.selectedAnswerIndex===t.correct?r+="X":r+="."})),console.log("Questions answered:",s),console.log("Questions correct:",n),console.log("Final decision:",this.finalDecision),console.log("Safe cash amount:",this.safeCash),console.log("Gamble amount:",e),console.log("Threhold amount:",this.thresholdAmount),console.log("Results:",r),this.socket.emit("client:saveresults",`${s}\t${n}\t${this.safeCash}\t${e}\t${this.thresholdAmount}\t${this.finalDecision}\t${r}`);const a=this.add.container().setDepth(10),h=this.add.text(1280,this.getY(100),"Thanks for playing!",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(.5).setFontSize(this.getY(60)),c=this.add.text(720,this.getY(160),"",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(0,0).setFontSize(this.getY(40));c.setWordWrapWidth(1100),c.setText(`Answered correctly: ${n} out of ${s}\nSafe cash: $ ${this.safeCash}\nMoneytree prize: $ ${e}\nAll-In Amount: ${this.allinCash}\n\nClick 'PLAY AGAIN' if you'd like to try with a different set of questions`);const l=this.add.text(1280,c.y+c.height+this.getY(360),"PLAY AGAIN",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(48)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(i.SPLASH)})).on("pointerover",(()=>l.setBackgroundColor("#0000ff"))).on("pointerout",(()=>l.setBackgroundColor("#000080")));a.add([h,c,l]),this.FSM.onNextStateChange((()=>{a.destroy(!0)}))}getPlayerBySessionID(t){return this.add.container(0,0)}arrangeIncorrectAnswers(){const t=this.incorrectAnswerContainer.list,e=this.getY(48);t.forEach(((t,s)=>{const n=s*e;t.setY(n)}))}sceneShutdown(){console.log("MoneyTree:: sceneShutdown...")}},parent:"container"};if(!("PhaserGameInstance"in window)){const t=new Phaser.Game(jt);console.log("Standalone MoneyTree game created:",t),window.PhaserGameInstance=t}}();
//# sourceMappingURL=moneytree.min.js.map
