!function(){"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e,s=t(Phaser);class n extends s.default.Scene{constructor(){super(...arguments),Object.defineProperty(this,"resizeHandler",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shutdownHandler",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"socket",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}init(){console.log(`${this.scene.key}:: BaseScene.init: hello`),this.resizeHandler=t=>{this.handleResize(t)},this.shutdownHandler=()=>{this.shutdown()},this.scale.on("resize",this.resizeHandler),this.events.on("shutdown",this.shutdownHandler),this.handleResize(this.scale.gameSize);const t=this.plugins.get("SocketManagerPlugin");if(!t)throw new Error("SocketManagerPlugin not found");const e=t.getSocket();if(!e)throw new Error("Socket not initialized");this.socket=e,this.socket.on("connection",(function(t){console.log("Connected to server:",t)}))}handleResize(t){console.log(`${this.scene.key}:: BaseScene.handleResize:`,t.width,t.height);const e=t.width/1920,s=t.height/e,n=this.cameras.main;n.setOrigin(0,0),n.setZoom(e),this.updateHeight(s)}updateHeight(t){console.log("BaseScene:: updateHeight:",t),n.currentHeight=t}getY(t){return t*this.getScaleFactor()}getScaleFactor(){return n.currentHeight/1080}shutdown(){console.log("BaseScene:: shutdown"),this.scale.off("resize",this.resizeHandler),this.events.off("shutdown",this.shutdownHandler),this.socket.removeAllListeners(),this.sceneShutdown()}}Object.defineProperty(n,"currentHeight",{enumerable:!0,configurable:!0,writable:!0,value:1080});class i{constructor(t,e,s){Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"transitions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stateActions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"persistentCallbacks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"singleUseCallbacks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.state=t,this.transitions=e,this.stateActions=s}start(){console.log(`Starting FSM in state: ${this.state}`),this.handleStateChange(this.state)}nextState(){const t=this.transitions[this.state];if(!(t.length>0))throw new Error(`No available transitions from ${this.state}`);{const e=t[0];this.transitionTo(e)}}canTransitionTo(t){return this.transitions[this.state]?.includes(t)??!1}transitionTo(t){if(console.log(`Transitioning from ${this.state} to ${t}`),!this.canTransitionTo(t))throw new Error(`Invalid transition from ${this.state} to ${t}`);this.forceTransitionTo(t)}forceTransitionTo(t){const e=this.state;this.state=t,this.persistentCallbacks.forEach((s=>s(t,e))),this.singleUseCallbacks.forEach((s=>s(t,e))),this.singleUseCallbacks=[],this.handleStateChange(t)}onStateChange(t){this.persistentCallbacks.push(t)}onNextStateChange(t){this.singleUseCallbacks.push(t)}handleStateChange(t){const e=this.stateActions[t];e&&e()}getState(){return this.state}getAllStates(){return Object.keys(this.stateActions)}}!function(t){t.SPLASH="SPLASH",t.INTRO="INTRO",t.CHOOSE_ENVELOPE="CHOOSE_ENVELOPE",t.INTRO_ROUND="INTRO_ROUND",t.QUESTION="QUESTION",t.ANSWER="ANSWER",t.END_ROUND="END_ROUND",t.FINAL_CHOICE="FINAL_CHOICE",t.PLAY_SAFE="PLAY_SAFE",t.CHECK_ENVELOPE="CHECK_ENVELOPE",t.GAMBLE="GAMBLE",t.GAMBLE_WON="GAMBLE_WON",t.GAMBLE_LOST="GAMBLE_LOST",t.END_QUIZ="END_QUIZ",t.SAVE_RESULTS="SAVE_RESULTS",t.DEBUG="DEBUG"}(e||(e={}));var o=e;class r{constructor(t,e,s){Object.defineProperty(this,"scene",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fsm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mockStateCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.scene=t,this.fsm=e,this.mockStateCallback=s,this.buildUI()}buildUI(){this.container=this.scene.add.container(10,10).setDepth(9999);const t=this.scene.add.rectangle(0,0,200,300,0,.7).setOrigin(0).setScrollFactor(0);this.container.add(t);const e=this.fsm.getAllStates();let s=10;e.forEach((t=>{const e=this.scene.add.text(10,s,t,{font:"16px monospace",color:"#ffffff",backgroundColor:"#333333",padding:{x:5,y:5}}).setData("name",t).setInteractive({useHandCursor:!0}).setScrollFactor(0);e.on("pointerdown",(()=>{this.transitionTo(t)})),this.container.add(e),s+=30})),this.fsm.onStateChange((t=>this.showState(t))),this.hide()}showState(t){console.log("StateDebugger: showState:",t),this.container.getAll().forEach((e=>{if(e instanceof Phaser.GameObjects.Text){const s=e.getData("name")===t;e.setStyle({backgroundColor:s?"#666666":"#333333"})}}))}transitionTo(t){console.log(`Debug: Forcing transition to state: ${t}`),this.mockStateCallback(t),this.fsm.forceTransitionTo(t)}show(){this.container.setVisible(!0)}hide(){this.container.setVisible(!1)}toggle(){this.container.setVisible(!this.container.visible)}}const a="#ffffff";class h extends Phaser.GameObjects.Container{constructor(t,e){super(t),Object.defineProperty(this,"background",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=t.add.text(0,0,`${e}`).setFontFamily("Arial").setFontStyle("bold").setFontSize(t.getY(24)).setColor(a).setOrigin(.5);const s=t.getY(6),n=this.text.width+40,i=this.text.height+2*s;this.background=t.add.rectangle(0,0,n,i).setOrigin(.5,.5).setStrokeStyle(1),this.setSlotState("empty"),this.add([this.background,this.text])}setSlotState(t){"empty"==t?(this.background.setFillStyle(Phaser.Display.Color.HexStringToColor("#5555AA").color),this.background.setStrokeStyle(.5,Phaser.Display.Color.HexStringToColor("#aaaaff").color),this.text.setColor(a)):(this.background.setFillStyle(Phaser.Display.Color.HexStringToColor("#333333").color),this.background.setStrokeStyle(.5,Phaser.Display.Color.HexStringToColor("#555555").color),this.text.setColor("#000000")),this.state=t}setText(t,e=20){this.text.setText(`${t}`);const s=this.text.width+2*e,n=this.text.height+2*e;this.background.setSize(s,n)}highlightSlot(){this.background.setFillStyle(Phaser.Display.Color.HexStringToColor("#ffff00").color),this.background.setStrokeStyle(4,Phaser.Display.Color.HexStringToColor("#5555AA").color),this.text.setColor("#000000")}unhighlightSlot(){this.setSlotState(this.state)}setBackgroundColor(t){this.background.setFillStyle(Phaser.Display.Color.HexStringToColor(t).color)}setBorderColor(t){this.background.setStrokeStyle(4,Phaser.Display.Color.HexStringToColor(t).color)}setTextColor(t){this.text.setColor(t)}destroy(){this.destroy()}}class c extends Phaser.GameObjects.Container{constructor(t,e,s,n,i){super(t,s,0),Object.defineProperty(this,"slots",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"slotData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.slotData=e,this.createTree(n,i)}createTree(t,e){const s=(e-t)/(this.slotData.length-1);for(let e=0;e<this.slotData.length;e++){const n=new h(this.scene,this.slotData[e]);n.setX(0),n.setY(t+e*s),this.add(n),this.slots.push(n)}}animateCorrectAnswer(t,e){console.log("Slots:",this.slots),this.slots.map((t=>{console.log("slot:",t.state)}));const s=this.slots.map(((t,e)=>({slot:t,i:e}))).filter((({slot:t})=>"revealed"!==t.state)).map((({i:t})=>t));if(0===s.length)return void console.warn("No available slots to animate!");const n=s.indexOf(t);if(-1===n)return void console.error("Target index not in available slots!");console.log("Available indices:",s,"Target Index:",n);var i=[s[0]];Phaser.Math.Between(1,100)>0&&(i=s.slice().reverse());for(var o=0;o<Phaser.Math.Between(1,4);o++)i=i.concat(s.slice(1),s.slice(0,-1).reverse());n>0&&(i=i.concat(s.slice(1,n),s[n])),console.log("Journey:",i);const r=this.buildDistanceLUT();r[r.length-1]=1;var a=this.slots[i[0]];this.scene.tweens.addCounter({from:0,to:1,duration:i.length*Phaser.Math.Between(40,70),onUpdate:t=>{const e=t.getValue(),s=Math.round(e*(r.length-1)),n=r[s],o=Math.min(Math.round(n*(i.length-1)),i.length-1),h=this.slots[i[o]];h!==a&&(this.scene.sound.play("lowtick",{volume:.5}),h.highlightSlot(),a.unhighlightSlot(),a=h)},onComplete:()=>{console.log("onComplete: adding tween chain:",this.scene.time.timeScale,this.scene.tweens,this.slots,this.slots[t]),this.scene.sound.play("highlightslot");const s=this.scene.tweens.chain({targets:this.slots[t],tweens:[{scale:1,duration:200,onComplete:()=>{this.slots[t].unhighlightSlot()}},{scale:1,duration:70,onComplete:()=>{this.slots[t].highlightSlot()}}],repeat:4,onComplete:()=>{console.log("chain onComplete...:",s.timeScale,this.scene.time.timeScale),e()}})}})}speedCurve(t){return Math.pow(1-t,Phaser.Math.Between(15,25)/10)}buildDistanceLUT(t=1e3){const e=[];let s=0,n=0;for(let e=0;e<t;e++){const s=e/(t-1);n+=this.speedCurve(s)}for(let i=0;i<t;i++){const o=i/(t-1);s+=this.speedCurve(o),e.push(s/n)}return e}getEmptySlots(){return this.slots.filter((t=>"empty"===t.state))}getSlotIndex(t){return this.slots.indexOf(t)}getSlotByIndex(t){return this.slots[t]}updateSlots(t,e,s){for(const n of this.slots)n.setBackgroundColor(t),n.setTextColor(e),n.setBorderColor(s)}updateSlot(t,e,s,n){const i=this.slots[t];i.setBackgroundColor(e),i.setTextColor(s),i.setBorderColor(n)}setSlotState(t,e){this.slots[t].setSlotState(e)}setSlotText(t,e){this.slots[t].setText(e)}destroy(){super.destroy(!0)}}const l=Object.create(null);l.open="0",l.close="1",l.ping="2",l.pong="3",l.message="4",l.upgrade="5",l.noop="6";const u=Object.create(null);Object.keys(l).forEach((t=>{u[l[t]]=t}));const d={type:"error",data:"parser error"},f="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),p="function"==typeof ArrayBuffer,g=t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,y=({type:t,data:e},s,n)=>f&&e instanceof Blob?s?n(e):m(e,n):p&&(e instanceof ArrayBuffer||g(e))?s?n(e):m(new Blob([e]),n):n(l[t]+(e||"")),m=(t,e)=>{const s=new FileReader;return s.onload=function(){const t=s.result.split(",")[1];e("b"+(t||""))},s.readAsDataURL(t)};function b(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let w;const v="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let t=0;t<64;t++)v["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;const S="function"==typeof ArrayBuffer,k=(t,e)=>{if("string"!=typeof t)return{type:"message",data:x(t,e)};const s=t.charAt(0);return"b"===s?{type:"message",data:C(t.substring(1),e)}:u[s]?t.length>1?{type:u[s],data:t.substring(1)}:{type:u[s]}:d},C=(t,e)=>{if(S){const s=(t=>{let e,s,n,i,o,r=.75*t.length,a=t.length,h=0;"="===t[t.length-1]&&(r--,"="===t[t.length-2]&&r--);const c=new ArrayBuffer(r),l=new Uint8Array(c);for(e=0;e<a;e+=4)s=v[t.charCodeAt(e)],n=v[t.charCodeAt(e+1)],i=v[t.charCodeAt(e+2)],o=v[t.charCodeAt(e+3)],l[h++]=s<<2|n>>4,l[h++]=(15&n)<<4|i>>2,l[h++]=(3&i)<<6|63&o;return c})(t);return x(s,e)}return{base64:!0,data:t}},x=(t,e)=>"blob"===e?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,_=String.fromCharCode(30);let A;function E(t){return t.reduce(((t,e)=>t+e.length),0)}function O(t,e){if(t[0].length===e)return t.shift();const s=new Uint8Array(e);let n=0;for(let i=0;i<e;i++)s[i]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),s}function T(t){if(t)return function(t){for(var e in T.prototype)t[e]=T.prototype[e];return t}(t)}T.prototype.on=T.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},T.prototype.once=function(t,e){function s(){this.off(t,s),e.apply(this,arguments)}return s.fn=e,this.on(t,s),this},T.prototype.off=T.prototype.removeListener=T.prototype.removeAllListeners=T.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var s,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<n.length;i++)if((s=n[i])===e||s.fn===e){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},T.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),s=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(s){n=0;for(var i=(s=s.slice(0)).length;n<i;++n)s[n].apply(this,e)}return this},T.prototype.emitReserved=T.prototype.emit,T.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},T.prototype.hasListeners=function(t){return!!this.listeners(t).length};const I="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),q="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function N(t,...e){return e.reduce(((e,s)=>(t.hasOwnProperty(s)&&(e[s]=t[s]),e)),{})}const F=q.setTimeout,P=q.clearTimeout;function B(t,e){e.useNativeTimers?(t.setTimeoutFn=F.bind(q),t.clearTimeoutFn=P.bind(q)):(t.setTimeoutFn=q.setTimeout.bind(q),t.clearTimeoutFn=q.clearTimeout.bind(q))}function R(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class L extends Error{constructor(t,e,s){super(t),this.description=e,this.context=s,this.type="TransportError"}}class D extends T{constructor(t){super(),this.writable=!1,B(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,s){return super.emitReserved("error",new L(t,e,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=k(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return-1===t.indexOf(":")?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(t){const e=function(t){let e="";for(let s in t)t.hasOwnProperty(s)&&(e.length&&(e+="&"),e+=encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return e}(t);return e.length?"?"+e:""}}class M extends D{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let t=0;this._polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){((t,e)=>{const s=t.split(_),n=[];for(let t=0;t<s.length;t++){const i=k(s[t],e);if(n.push(i),"error"===i.type)break}return n})(t,this.socket.binaryType).forEach((t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)})),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,((t,e)=>{const s=t.length,n=new Array(s);let i=0;t.forEach(((t,o)=>{y(t,!1,(t=>{n[o]=t,++i===s&&e(n.join(_))}))}))})(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=R()),this.supportsBinary||e.sid||(e.b64=1),this.createUri(t,e)}}let W=!1;try{W="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){}const Y=W;function j(){}class H extends M{constructor(t){if(super(t),"undefined"!=typeof location){const e="https:"===location.protocol;let s=location.port;s||(s=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,e){const s=this.request({method:"POST",data:t});s.on("success",e),s.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)})),this.pollXhr=t}}class U extends T{constructor(t,e,s){super(),this.createRequest=t,B(this,s),this._opts=s,this._method=s.method||"GET",this._uri=e,this._data=void 0!==s.data?s.data:null,this._create()}_create(){var t;const e=N(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(e);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let t in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(t)&&s.setRequestHeader(t,this._opts.extraHeaders[t])}}catch(t){}if("POST"===this._method)try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{s.setRequestHeader("Accept","*/*")}catch(t){}null===(t=this._opts.cookieJar)||void 0===t||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var t;3===s.readyState&&(null===(t=this._opts.cookieJar)||void 0===t||t.parseCookies(s.getResponseHeader("set-cookie"))),4===s.readyState&&(200===s.status||1223===s.status?this._onLoad():this.setTimeoutFn((()=>{this._onError("number"==typeof s.status?s.status:0)}),0))},s.send(this._data)}catch(t){return void this.setTimeoutFn((()=>{this._onError(t)}),0)}"undefined"!=typeof document&&(this._index=U.requestsCount++,U.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=j,t)try{this._xhr.abort()}catch(t){}"undefined"!=typeof document&&delete U.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}function z(){for(let t in U.requests)U.requests.hasOwnProperty(t)&&U.requests[t].abort()}U.requestsCount=0,U.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",z):"function"==typeof addEventListener&&addEventListener("onpagehide"in q?"pagehide":"unload",z,!1));const Q=function(){const t=$({xdomain:!1});return t&&null!==t.responseType}();function $(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||Y))return new XMLHttpRequest}catch(t){}if(!e)try{return new(q[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}const G="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class V extends D{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,s=G?{}:N(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,s)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;y(s,this.supportsBinary,(t=>{try{this.doWrite(s,t)}catch(t){}n&&I((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=R()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const K=q.WebSocket||q.MozWebSocket,J={websocket:class extends V{createSocket(t,e,s){return G?new K(t,e,s):e?new K(t,e):new K(t)}doWrite(t,e){this.ws.send(e)}},webtransport:class extends D{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then((()=>{this.onClose()})).catch((t=>{this.onError("webtransport error",t)})),this._transport.ready.then((()=>{this._transport.createBidirectionalStream().then((t=>{const e=function(t,e){A||(A=new TextDecoder);const s=[];let n=0,i=-1,o=!1;return new TransformStream({transform(r,a){for(s.push(r);;){if(0===n){if(E(s)<1)break;const t=O(s,1);o=!(128&~t[0]),i=127&t[0],n=i<126?3:126===i?1:2}else if(1===n){if(E(s)<2)break;const t=O(s,2);i=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),n=3}else if(2===n){if(E(s)<8)break;const t=O(s,8),e=new DataView(t.buffer,t.byteOffset,t.length),o=e.getUint32(0);if(o>Math.pow(2,21)-1){a.enqueue(d);break}i=o*Math.pow(2,32)+e.getUint32(4),n=3}else{if(E(s)<i)break;const t=O(s,i);a.enqueue(k(o?t:A.decode(t),e)),n=0}if(0===i||i>t){a.enqueue(d);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(e).getReader(),n=new TransformStream({transform(t,e){!function(t,e){f&&t.data instanceof Blob?t.data.arrayBuffer().then(b).then(e):p&&(t.data instanceof ArrayBuffer||g(t.data))?e(b(t.data)):y(t,!1,(t=>{w||(w=new TextEncoder),e(w.encode(t))}))}(t,(s=>{const n=s.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const t=new DataView(i.buffer);t.setUint8(0,126),t.setUint16(1,n)}else{i=new Uint8Array(9);const t=new DataView(i.buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(n))}t.data&&"string"!=typeof t.data&&(i[0]|=128),e.enqueue(i),e.enqueue(s)}))}});n.readable.pipeTo(t.writable),this._writer=n.writable.getWriter();const i=()=>{s.read().then((({done:t,value:e})=>{t||(this.onPacket(e),i())})).catch((t=>{}))};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then((()=>this.onOpen()))}))}))}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;this._writer.write(s).then((()=>{n&&I((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var t;null===(t=this._transport)||void 0===t||t.close()}},polling:class extends H{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=Q&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new U($,this.uri(),t)}}},Z=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,X=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function tt(t){if(t.length>8e3)throw"URI too long";const e=t,s=t.indexOf("["),n=t.indexOf("]");-1!=s&&-1!=n&&(t=t.substring(0,s)+t.substring(s,n).replace(/:/g,";")+t.substring(n,t.length));let i=Z.exec(t||""),o={},r=14;for(;r--;)o[X[r]]=i[r]||"";return-1!=s&&-1!=n&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(t,e){const s=e.replace(/\/{2,9}/g,"/").split("/");return"/"!=e.slice(0,1)&&0!==e.length||s.splice(0,1),"/"==e.slice(-1)&&s.splice(s.length-1,1),s}(0,o.path),o.queryKey=function(t,e){const s={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(s[e]=n)})),s}(0,o.query),o}const et="function"==typeof addEventListener&&"function"==typeof removeEventListener,st=[];et&&addEventListener("offline",(()=>{st.forEach((t=>t()))}),!1);class nt extends T{constructor(t,e){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&"object"==typeof t&&(e=t,t=null),t){const s=tt(t);e.hostname=s.host,e.secure="https"===s.protocol||"wss"===s.protocol,e.port=s.port,s.query&&(e.query=s.query)}else e.host&&(e.hostname=tt(e.host).host);B(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach((t=>{const e=t.prototype.name;this.transports.push(e),this._transportsByName[e]=t})),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(t){let e={},s=t.split("&");for(let t=0,n=s.length;t<n;t++){let n=s[t].split("=");e[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return e}(this.opts.query)),et&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},st.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const s=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);const t=this.opts.rememberUpgrade&&nt.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",(t=>this._onClose("transport close",t)))}onOpen(){this.readyState="open",nt.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn((()=>{this._onClose("ping timeout")}),t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const n=this.writeBuffer[s].data;if(n&&(t+="string"==typeof(e=n)?function(t){let e=0,s=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?s+=1:e<2048?s+=2:e<55296||e>=57344?s+=3:(n++,s+=4);return s}(e):Math.ceil(1.33*(e.byteLength||e.size))),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}var e;return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,I((()=>{this._onClose("ping timeout")}),this.setTimeoutFn)),t}write(t,e,s){return this._sendPacket("message",t,e,s),this}send(t,e,s){return this._sendPacket("message",t,e,s),this}_sendPacket(t,e,s,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof s&&(n=s,s=null),"closing"===this.readyState||"closed"===this.readyState)return;(s=s||{}).compress=!1!==s.compress;const i={type:t,data:e,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},s=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?s():t()})):this.upgrading?s():t()),this}_onError(t){if(nt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),et&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const t=st.indexOf(this._offlineEventListener);-1!==t&&st.splice(t,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}nt.protocol=4;class it extends nt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),s=!1;nt.priorWebsocketSuccess=!1;const n=()=>{s||(e.send([{type:"ping",data:"probe"}]),e.once("packet",(t=>{if(!s)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;nt.priorWebsocketSuccess="websocket"===e.name,this.transport.pause((()=>{s||"closed"!==this.readyState&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())}))}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}})))};function i(){s||(s=!0,c(),e.close(),e=null)}const o=t=>{const s=new Error("probe error: "+t);s.transport=e.name,i(),this.emitReserved("upgradeError",s)};function r(){o("transport closed")}function a(){o("socket closed")}function h(t){e&&t.name!==e.name&&i()}const c=()=>{e.removeListener("open",n),e.removeListener("error",o),e.removeListener("close",r),this.off("close",a),this.off("upgrading",h)};e.once("open",n),e.once("error",o),e.once("close",r),this.once("close",a),this.once("upgrading",h),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn((()=>{s||e.open()}),200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&e.push(t[s]);return e}}class ot extends it{constructor(t,e={}){const s="object"==typeof t?t:e;(!s.transports||s.transports&&"string"==typeof s.transports[0])&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map((t=>J[t])).filter((t=>!!t))),super(t,s)}}const rt="function"==typeof ArrayBuffer,at=Object.prototype.toString,ht="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===at.call(Blob),ct="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===at.call(File);function lt(t){return rt&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||ht&&t instanceof Blob||ct&&t instanceof File}function ut(t,e){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let e=0,s=t.length;e<s;e++)if(ut(t[e]))return!0;return!1}if(lt(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return ut(t.toJSON(),!0);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&ut(t[e]))return!0;return!1}function dt(t){const e=[],s=t.data,n=t;return n.data=ft(s,e),n.attachments=e.length,{packet:n,buffers:e}}function ft(t,e){if(!t)return t;if(lt(t)){const s={_placeholder:!0,num:e.length};return e.push(t),s}if(Array.isArray(t)){const s=new Array(t.length);for(let n=0;n<t.length;n++)s[n]=ft(t[n],e);return s}if("object"==typeof t&&!(t instanceof Date)){const s={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=ft(t[n],e));return s}return t}function pt(t,e){return t.data=gt(t.data,e),delete t.attachments,t}function gt(t,e){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=gt(t[s],e);else if("object"==typeof t)for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=gt(t[s],e));return t}const yt=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var mt;function bt(t){return"[object Object]"===Object.prototype.toString.call(t)}!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(mt||(mt={}));class wt extends T{constructor(t){super(),this.reviver=t}add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const s=e.type===mt.BINARY_EVENT;s||e.type===mt.BINARY_ACK?(e.type=s?mt.EVENT:mt.ACK,this.reconstructor=new vt(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!lt(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const s={type:Number(t.charAt(0))};if(void 0===mt[s.type])throw new Error("unknown packet type "+s.type);if(s.type===mt.BINARY_EVENT||s.type===mt.BINARY_ACK){const n=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const i=t.substring(n,e);if(i!=Number(i)||"-"!==t.charAt(e))throw new Error("Illegal attachments");s.attachments=Number(i)}if("/"===t.charAt(e+1)){const n=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);s.nsp=t.substring(n,e)}else s.nsp="/";const n=t.charAt(e+1);if(""!==n&&Number(n)==n){const n=e+1;for(;++e;){const s=t.charAt(e);if(null==s||Number(s)!=s){--e;break}if(e===t.length)break}s.id=Number(t.substring(n,e+1))}if(t.charAt(++e)){const n=this.tryParse(t.substr(e));if(!wt.isPayloadValid(s.type,n))throw new Error("invalid payload");s.data=n}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}static isPayloadValid(t,e){switch(t){case mt.CONNECT:return bt(e);case mt.DISCONNECT:return void 0===e;case mt.CONNECT_ERROR:return"string"==typeof e||bt(e);case mt.EVENT:case mt.BINARY_EVENT:return Array.isArray(e)&&("number"==typeof e[0]||"string"==typeof e[0]&&-1===yt.indexOf(e[0]));case mt.ACK:case mt.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class vt{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=pt(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}var St=Object.freeze({__proto__:null,protocol:5,get PacketType(){return mt},Encoder:class{constructor(t){this.replacer=t}encode(t){return t.type!==mt.EVENT&&t.type!==mt.ACK||!ut(t)?[this.encodeAsString(t)]:this.encodeAsBinary({type:t.type===mt.EVENT?mt.BINARY_EVENT:mt.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})}encodeAsString(t){let e=""+t.type;return t.type!==mt.BINARY_EVENT&&t.type!==mt.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=dt(t),s=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(s),n}},Decoder:wt});function kt(t,e,s){return t.on(e,s),function(){t.off(e,s)}}const Ct=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class xt extends T{constructor(t,e,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[kt(t,"open",this.onopen.bind(this)),kt(t,"packet",this.onpacket.bind(this)),kt(t,"error",this.onerror.bind(this)),kt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var s,n,i;if(Ct.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const o={type:mt.EVENT,data:e,options:{}};if(o.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++,s=e.pop();this._registerAckCallback(t,s),o.id=t}const r=null===(n=null===(s=this.io.engine)||void 0===s?void 0:s.transport)||void 0===n?void 0:n.writable,a=this.connected&&!(null===(i=this.io.engine)||void 0===i?void 0:i._hasPingExpired());return this.flags.volatile&&!r||(a?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,e){var s;const n=null!==(s=this.flags.timeout)&&void 0!==s?s:this._opts.ackTimeout;if(void 0===n)return void(this.acks[t]=e);const i=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))}),n),o=(...t)=>{this.io.clearTimeoutFn(i),e.apply(this,t)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...e){return new Promise(((s,n)=>{const i=(t,e)=>t?n(t):s(e);i.withError=!0,e.push(i),this.emit(t,...e)}))}_addToQueue(t){let e;"function"==typeof t[t.length-1]&&(e=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push(((t,...n)=>{if(s===this._queue[0])return null!==t?s.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(t)):(this._queue.shift(),e&&e(null,...n)),s.pending=!1,this._drainQueue()})),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||0===this._queue.length)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth((t=>{this._sendConnectPacket(t)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:mt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((t=>{if(!this.sendBuffer.some((e=>String(e.id)===t))){const e=this.acks[t];delete this.acks[t],e.withError&&e.call(this,new Error("socket has been disconnected"))}}))}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case mt.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case mt.EVENT:case mt.BINARY_EVENT:this.onevent(t);break;case mt.ACK:case mt.BINARY_ACK:this.onack(t);break;case mt.DISCONNECT:this.ondisconnect();break;case mt.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const s of e)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&"string"==typeof t[t.length-1]&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let s=!1;return function(...n){s||(s=!0,e.packet({type:mt.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t),this.packet(t)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:mt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const s of e)s.apply(this,t.data)}}}function _t(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}_t.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),s=Math.floor(e*this.jitter*t);t=1&Math.floor(10*e)?t+s:t-s}return 0|Math.min(t,this.max)},_t.prototype.reset=function(){this.attempts=0},_t.prototype.setMin=function(t){this.ms=t},_t.prototype.setMax=function(t){this.max=t},_t.prototype.setJitter=function(t){this.jitter=t};class At extends T{constructor(t,e){var s;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,B(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(s=e.randomizationFactor)&&void 0!==s?s:.5),this.backoff=new _t({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const n=e.parser||St;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new ot(this.uri,this.opts);const e=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const n=kt(e,"open",(function(){s.onopen(),t&&t()})),i=e=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",e),t?t(e):this.maybeReconnectOnOpen()},o=kt(e,"error",i);if(!1!==this._timeout){const t=this._timeout,s=this.setTimeoutFn((()=>{n(),i(new Error("timeout")),e.close()}),t);this.opts.autoUnref&&s.unref(),this.subs.push((()=>{this.clearTimeoutFn(s)}))}return this.subs.push(n),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(kt(t,"ping",this.onping.bind(this)),kt(t,"data",this.ondata.bind(this)),kt(t,"error",this.onerror.bind(this)),kt(t,"close",this.onclose.bind(this)),kt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){I((()=>{this.emitReserved("packet",t)}),this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new xt(this,t,e),this.nsps[t]=s),s}_destroy(t){const e=Object.keys(this.nsps);for(const t of e)if(this.nsps[t].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let s=0;s<e.length;s++)this.engine.write(e[s],t.options)}cleanup(){this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var s;this.cleanup(),null===(s=this.engine)||void 0===s||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn((()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()})))}),e);this.opts.autoUnref&&s.unref(),this.subs.push((()=>{this.clearTimeoutFn(s)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Et={};function Ot(t,e){"object"==typeof t&&(e=t,t=void 0);const s=function(t,e="",s){let n=t;s=s||"undefined"!=typeof location&&location,null==t&&(t=s.protocol+"//"+s.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?s.protocol+t:s.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==s?s.protocol+"//"+t:"https://"+t),n=tt(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+e,n.href=n.protocol+"://"+i+(s&&s.port===n.port?"":":"+n.port),n}(t,(e=e||{}).path||"/socket.io"),n=s.source,i=s.id,o=s.path,r=Et[i]&&o in Et[i].nsps;let a;return e.forceNew||e["force new connection"]||!1===e.multiplex||r?a=new At(n,e):(Et[i]||(Et[i]=new At(n,e)),a=Et[i]),s.query&&!e.query&&(e.query=s.queryKey),a.socket(s.path,e)}Object.assign(Ot,{Manager:At,Socket:xt,io:Ot,connect:Ot});class Tt extends s.default.Plugins.BasePlugin{constructor(t){super(t),Object.defineProperty(this,"socket",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),console.log("SocketManagerPlugin constructor")}init(){console.log("SocketManagerPlugin:: init"),this.socket=Ot(),this.socket.on("connection",(t=>{console.log("SocketManager: Connected to server:",t)}))}getSocket(){return this.socket}disconnect(){this.socket&&this.socket.disconnect()}}function It(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}console.log("SocketManager loaded...");var qt,Nt,Ft={exports:{}},Pt=(qt||(qt=1,Nt=Ft,function(){function t(t,e,s){return t.call.apply(t.bind,arguments)}function e(t,e,s){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,n),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function s(n,i,o){return(s=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?t:e).apply(null,arguments)}var n=Date.now||function(){return+new Date};function i(t,e){this.a=t,this.o=e||t,this.c=this.o.document}var o=!!window.FontFace;function r(t,e,s,n){if(e=t.c.createElement(e),s)for(var i in s)s.hasOwnProperty(i)&&("style"==i?e.style.cssText=s[i]:e.setAttribute(i,s[i]));return n&&e.appendChild(t.c.createTextNode(n)),e}function a(t,e,s){(t=t.c.getElementsByTagName(e)[0])||(t=document.documentElement),t.insertBefore(s,t.lastChild)}function h(t){t.parentNode&&t.parentNode.removeChild(t)}function c(t,e,s){e=e||[],s=s||[];for(var n=t.className.split(/\s+/),i=0;i<e.length;i+=1){for(var o=!1,r=0;r<n.length;r+=1)if(e[i]===n[r]){o=!0;break}o||n.push(e[i])}for(e=[],i=0;i<n.length;i+=1){for(o=!1,r=0;r<s.length;r+=1)if(n[i]===s[r]){o=!0;break}o||e.push(n[i])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function l(t,e){for(var s=t.className.split(/\s+/),n=0,i=s.length;n<i;n++)if(s[n]==e)return!0;return!1}function u(t,e,s){function n(){l&&i&&h&&(l(c),l=null)}e=r(t,"link",{rel:"stylesheet",href:e,media:"all"});var i=!1,h=!0,c=null,l=s||null;o?(e.onload=function(){i=!0,n()},e.onerror=function(){i=!0,c=Error("Stylesheet failed to load"),n()}):setTimeout((function(){i=!0,n()}),0),a(t,"head",e)}function d(t,e,s,n){var i=t.c.getElementsByTagName("head")[0];if(i){var o=r(t,"script",{src:e}),a=!1;return o.onload=o.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,s&&s(null),o.onload=o.onreadystatechange=null,"HEAD"==o.parentNode.tagName&&i.removeChild(o))},i.appendChild(o),setTimeout((function(){a||(a=!0,s&&s(Error("Script load timeout")))}),n||5e3),o}return null}function f(){this.a=0,this.c=null}function p(t){return t.a++,function(){t.a--,y(t)}}function g(t,e){t.c=e,y(t)}function y(t){0==t.a&&t.c&&(t.c(),t.c=null)}function m(t){this.a=t||"-"}function b(t,e){this.c=t,this.f=4,this.a="n";var s=(e||"n4").match(/^([nio])([1-9])$/i);s&&(this.a=s[1],this.f=parseInt(s[2],10))}function w(t){var e=[];t=t.split(/,\s*/);for(var s=0;s<t.length;s++){var n=t[s].replace(/['"]/g,"");-1!=n.indexOf(" ")||/^\d/.test(n)?e.push("'"+n+"'"):e.push(n)}return e.join(",")}function v(t){return t.a+t.f}function S(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function k(t){var e=4,s="n",n=null;return t&&((n=t.match(/(normal|oblique|italic)/i))&&n[1]&&(s=n[1].substr(0,1).toLowerCase()),(n=t.match(/([1-9]00|normal|bold)/i))&&n[1]&&(/bold/i.test(n[1])?e=7:/[1-9]00/.test(n[1])&&(e=parseInt(n[1].substr(0,1),10)))),s+e}function C(t,e){this.c=t,this.f=t.o.document.documentElement,this.h=e,this.a=new m("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function x(t){if(t.g){var e=l(t.f,t.a.c("wf","active")),s=[],n=[t.a.c("wf","loading")];e||s.push(t.a.c("wf","inactive")),c(t.f,s,n)}_(t,"inactive")}function _(t,e,s){t.j&&t.h[e]&&(s?t.h[e](s.c,v(s)):t.h[e]())}function A(){this.c={}}function E(t,e){this.c=t,this.f=e,this.a=r(this.c,"span",{"aria-hidden":"true"},this.f)}function O(t){a(t.c,"body",t.a)}function T(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+w(t.c)+";font-style:"+S(t)+";font-weight:"+t.f+"00;"}function I(t,e,s,n,i,o){this.g=t,this.j=e,this.a=n,this.c=s,this.f=i||3e3,this.h=o||void 0}function q(t,e,s,n,i,o,r){this.v=t,this.B=e,this.c=s,this.a=n,this.s=r||"BESbswy",this.f={},this.w=i||3e3,this.u=o||null,this.m=this.j=this.h=this.g=null,this.g=new E(this.c,this.s),this.h=new E(this.c,this.s),this.j=new E(this.c,this.s),this.m=new E(this.c,this.s),t=T(t=new b(this.a.c+",serif",v(this.a))),this.g.a.style.cssText=t,t=T(t=new b(this.a.c+",sans-serif",v(this.a))),this.h.a.style.cssText=t,t=T(t=new b("serif",v(this.a))),this.j.a.style.cssText=t,t=T(t=new b("sans-serif",v(this.a))),this.m.a.style.cssText=t,O(this.g),O(this.h),O(this.j),O(this.m)}m.prototype.c=function(t){for(var e=[],s=0;s<arguments.length;s++)e.push(arguments[s].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},I.prototype.start=function(){var t=this.c.o.document,e=this,s=n(),i=new Promise((function(i,o){!function r(){n()-s>=e.f?o():t.fonts.load(function(t){return S(t)+" "+t.f+"00 300px "+w(t.c)}(e.a),e.h).then((function(t){1<=t.length?i():setTimeout(r,25)}),(function(){o()}))}()})),o=null,r=new Promise((function(t,s){o=setTimeout(s,e.f)}));Promise.race([r,i]).then((function(){o&&(clearTimeout(o),o=null),e.g(e.a)}),(function(){e.j(e.a)}))};var N={D:"serif",C:"sans-serif"},F=null;function P(){if(null===F){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);F=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))}return F}function B(t,e,s){for(var n in N)if(N.hasOwnProperty(n)&&e===t.f[N[n]]&&s===t.f[N[n]])return!0;return!1}function R(t){var e,i=t.g.a.offsetWidth,o=t.h.a.offsetWidth;(e=i===t.f.serif&&o===t.f["sans-serif"])||(e=P()&&B(t,i,o)),e?n()-t.A>=t.w?P()&&B(t,i,o)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?L(t,t.v):L(t,t.B):function(t){setTimeout(s((function(){R(this)}),t),50)}(t):L(t,t.v)}function L(t,e){setTimeout(s((function(){h(this.g.a),h(this.h.a),h(this.j.a),h(this.m.a),e(this.a)}),t),0)}function D(t,e,s){this.c=t,this.a=e,this.f=0,this.m=this.j=!1,this.s=s}q.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=n(),R(this)};var M=null;function W(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&c(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),_(t,"active")):x(t.a))}function Y(t){this.j=t,this.a=new A,this.h=0,this.f=this.g=!0}function j(t,e,n,i,o){var r=0==--t.h;(t.f||t.g)&&setTimeout((function(){var t=o||null,a=i||{};if(0===n.length&&r)x(e.a);else{e.f+=n.length,r&&(e.j=r);var h,l=[];for(h=0;h<n.length;h++){var u=n[h],d=a[u.c],f=e.a,p=u;if(f.g&&c(f.f,[f.a.c("wf",p.c,v(p).toString(),"loading")]),_(f,"fontloading",p),f=null,null===M)if(window.FontFace){p=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var g=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);M=p?42<parseInt(p[1],10):!g}else M=!1;f=M?new I(s(e.g,e),s(e.h,e),e.c,u,e.s,d):new q(s(e.g,e),s(e.h,e),e.c,u,e.s,t,d),l.push(f)}for(h=0;h<l.length;h++)l[h].start()}}),0)}function H(t,e){this.c=t,this.a=e}function U(t,e){this.c=t,this.a=e}function z(t,e){this.c=t||Q,this.a=[],this.f=[],this.g=e||""}D.prototype.g=function(t){var e=this.a;e.g&&c(e.f,[e.a.c("wf",t.c,v(t).toString(),"active")],[e.a.c("wf",t.c,v(t).toString(),"loading"),e.a.c("wf",t.c,v(t).toString(),"inactive")]),_(e,"fontactive",t),this.m=!0,W(this)},D.prototype.h=function(t){var e=this.a;if(e.g){var s=l(e.f,e.a.c("wf",t.c,v(t).toString(),"active")),n=[],i=[e.a.c("wf",t.c,v(t).toString(),"loading")];s||n.push(e.a.c("wf",t.c,v(t).toString(),"inactive")),c(e.f,n,i)}_(e,"fontinactive",t),W(this)},Y.prototype.load=function(t){this.c=new i(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes,function(t,e,s){var n=[],i=s.timeout;!function(t){t.g&&c(t.f,[t.a.c("wf","loading")]),_(t,"loading")}(e),n=function(t,e,s){var n,i=[];for(n in e)if(e.hasOwnProperty(n)){var o=t.c[n];o&&i.push(o(e[n],s))}return i}(t.a,s,t.c);var o=new D(t.c,e,i);for(t.h=n.length,e=0,s=n.length;e<s;e++)n[e].load((function(e,s,n){j(t,o,e,s,n)}))}(this,new C(this.c,t),t)},H.prototype.load=function(t){function e(){if(o["__mti_fntLst"+n]){var s,i=o["__mti_fntLst"+n](),r=[];if(i)for(var a=0;a<i.length;a++){var h=i[a].fontfamily;null!=i[a].fontStyle&&null!=i[a].fontWeight?(s=i[a].fontStyle+i[a].fontWeight,r.push(new b(h,s))):r.push(new b(h))}t(r)}else setTimeout((function(){e()}),50)}var s=this,n=s.a.projectId,i=s.a.version;if(n){var o=s.c.o;d(this.c,(s.a.api||"https://fast.fonts.net/jsapi")+"/"+n+".js"+(i?"?v="+i:""),(function(i){i?t([]):(o["__MonotypeConfiguration__"+n]=function(){return s.a},e())})).id="__MonotypeAPIScript__"+n}else t([])},U.prototype.load=function(t){var e,s,n=this.a.urls||[],i=this.a.families||[],o=this.a.testStrings||{},r=new f;for(e=0,s=n.length;e<s;e++)u(this.c,n[e],p(r));var a=[];for(e=0,s=i.length;e<s;e++)if((n=i[e].split(":"))[1])for(var h=n[1].split(","),c=0;c<h.length;c+=1)a.push(new b(n[0],h[c]));else a.push(new b(n[0]));g(r,(function(){t(a,o)}))};var Q="https://fonts.googleapis.com/css";function $(t){this.f=t,this.a=[],this.c={}}var G={latin:"BESbswy","latin-ext":"",cyrillic:"",greek:"",khmer:"",Hanuman:""},V={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},K={i:"i",italic:"i",n:"n",normal:"n"},J=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function Z(t,e){this.c=t,this.a=e}var X={Arimo:!0,Cousine:!0,Tinos:!0};function tt(t,e){this.c=t,this.a=e}function et(t,e){this.c=t,this.f=e,this.a=[]}Z.prototype.load=function(t){var e=new f,s=this.c,n=new z(this.a.api,this.a.text),i=this.a.families;!function(t,e){for(var s=e.length,n=0;n<s;n++){var i=e[n].split(":");3==i.length&&t.f.push(i.pop());var o="";2==i.length&&""!=i[1]&&(o=":"),t.a.push(i.join(o))}}(n,i);var o=new $(i);!function(t){for(var e=t.f.length,s=0;s<e;s++){var n=t.f[s].split(":"),i=n[0].replace(/\+/g," "),o=["n4"];if(2<=n.length){var r;if(r=[],a=n[1])for(var a,h=(a=a.split(",")).length,c=0;c<h;c++){var l;if((l=a[c]).match(/^[\w-]+$/))if(null==(u=J.exec(l.toLowerCase())))l="";else{if(l=null==(l=u[2])||""==l?"n":K[l],null==(u=u[1])||""==u)u="4";else var u=V[u]||(isNaN(u)?"4":u.substr(0,1));l=[l,u].join("")}else l="";l&&r.push(l)}0<r.length&&(o=r),3==n.length&&(r=[],0<(n=(n=n[2])?n.split(","):r).length&&(n=G[n[0]])&&(t.c[i]=n))}for(t.c[i]||(n=G[i])&&(t.c[i]=n),n=0;n<o.length;n+=1)t.a.push(new b(i,o[n]))}}(o),u(s,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,s=[],n=0;n<e;n++)s.push(t.a[n].replace(/ /g,"+"));return e=t.c+"?family="+s.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(n),p(e)),g(e,(function(){t(o.a,o.c,X)}))},tt.prototype.load=function(t){var e=this.a.id,s=this.c.o;e?d(this.c,(this.a.api||"https://use.typekit.net")+"/"+e+".js",(function(e){if(e)t([]);else if(s.Typekit&&s.Typekit.config&&s.Typekit.config.fn){e=s.Typekit.config.fn;for(var n=[],i=0;i<e.length;i+=2)for(var o=e[i],r=e[i+1],a=0;a<r.length;a++)n.push(new b(o,r[a]));try{s.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}t(n)}}),2e3):t([])},et.prototype.load=function(t){var e=this.f.id,s=this.c.o,n=this;e?(s.__webfontfontdeckmodule__||(s.__webfontfontdeckmodule__={}),s.__webfontfontdeckmodule__[e]=function(e,s){for(var i=0,o=s.fonts.length;i<o;++i){var r=s.fonts[i];n.a.push(new b(r.name,k("font-weight:"+r.weight+";font-style:"+r.style)))}t(n.a)},d(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(t){return t.o.location.hostname||t.a.location.hostname}(this.c)+"/"+e+".js",(function(e){e&&t([])}))):t([])};var st=new Y(window);st.a.c.custom=function(t,e){return new U(e,t)},st.a.c.fontdeck=function(t,e){return new et(e,t)},st.a.c.monotype=function(t,e){return new H(e,t)},st.a.c.typekit=function(t,e){return new tt(e,t)},st.a.c.google=function(t,e){return new Z(e,t)};var nt={load:s(st.load,st)};Nt.exports?Nt.exports=nt:(window.WebFont=nt,window.WebFontConfig&&st.load(window.WebFontConfig))}()),Ft.exports),Bt=It(Pt);const Rt=Phaser.Display.Canvas.CanvasPool;var Lt=function(t,e){var s=Rt.create(),n=s.getContext("2d",{willReadFrequently:!0}),i=`8px ${t}`;n.font=i;var o=Math.ceil(n.measureText(e).width),r=o,a=2*r;o===s.width&&a===s.height||(s.width=o,s.height=a),n.fillStyle="#000",n.fillRect(0,0,o,a),n.textBaseline="alphabetic",n.fillStyle="#fff",n.font=i,n.fillText(e,0,r);for(var h=n.getImageData(0,0,o,a).data,c=!1,l=0,u=h.length;l<u;l+=4)if(h[l]>0){c=!0;break}return Rt.remove(s),c};const Dt=Phaser.Loader.FILE_POPULATED,Mt=Phaser.Utils.Objects.GetValue;class Wt extends Phaser.Loader.File{load(){if(this.state===Dt)this.loader.nextFile(this,!0);else{var t=this.config;this.testString=Mt(t,"testString",void 0),void 0!==this.testString&&(this.testInterval=Mt(t,"testInterval",20),this.fontTests={},delete t.testString,delete t.testInterval),t.active=this.onLoad.bind(this),t.inactive=this.onError.bind(this),t.fontactive=this.onFontActive.bind(this),t.fontinactive=this.onFontInactive.bind(this),Bt.load(t)}}onLoad(){if(void 0===this.testString)this.loader.nextFile(this,!0);else{var t=function(){this.testFonts()?this.loader.nextFile(this,!0):setTimeout(t,this.testInterval)}.bind(this);t()}}onError(){this.loader.nextFile(this,!1)}onFontActive(t,e){var s;void 0!==this.testString&&void 0!==(s="string"==typeof this.testString?this.testString:this.testString[t])&&(this.fontTests[t]=s),this.loader.emit("webfontactive",this,t,e)}onFontInactive(t,e){this.loader.emit("webfontinactive",this,t,e)}testFonts(){var t=!0;for(var e in this.fontTests)Lt(e,this.fontTests[e])?delete this.fontTests[e]:t=!1;return t}}const Yt=Phaser.Utils.Objects.IsPlainObject,jt=function(t,e){return Yt(t)?(e=t).hasOwnProperty("config")?(e.type="webfont",e.url=""):e={key:"webfont",type:"webfont",url:"",config:e}:e={type:"webfont",url:"",key:t,config:e},this.addFile(new Wt(this,e)),this};class Ht extends Phaser.Plugins.BasePlugin{constructor(t){super(t),t.registerFileType("rexWebFont",jt)}addToScene(t){t.sys.load.rexWebFont=jt}}class Ut{constructor(t,e=-1){Object.defineProperty(this,"question",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"answers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"correct",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"questionIndex",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"selectedAnswerIndex",{enumerable:!0,configurable:!0,writable:!0,value:-1}),this.question=t.question,this.answers=t.answers,this.correct=t.correct,this.questionIndex=t.questionIndex,this.selectedAnswerIndex=-1}}const zt={type:Phaser.AUTO,width:1920,height:1080,scale:{mode:Phaser.Scale.RESIZE},plugins:{global:[{key:"SocketManagerPlugin",plugin:Tt,start:!1},{key:"rexWebFontLoader",plugin:Ht,start:!0}]},scene:class extends n{constructor(){super({key:"MoneyTree"}),Object.defineProperty(this,"moneyamounts",{enumerable:!0,configurable:!0,writable:!0,value:[1,2,5,10,25,50,75,100,200,500,1e3,2500,5e3,7500,1e4,15e3,2e4,3e4,5e4,75e3,1e5]}),Object.defineProperty(this,"questions",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"questionData1",{enumerable:!0,configurable:!0,writable:!0,value:[{questionIndex:20,question:"In literature, what is the name of the ship in Moby-Dick?",answers:["Pequod","Essex","Resolute"],correct:0},{questionIndex:19,question:"Which philosopher wrote Being and Time?",answers:["Martin Heidegger","Friedrich Nietzsche","Jean-Paul Sartre"],correct:0},{questionIndex:18,question:"Which Dutch scientist is credited with discovering Saturn's moon Titan?",answers:["Antonie van Leeuwenhoek","Christiaan Huygens","Hugo de Groot"],correct:1},{questionIndex:17,question:"What is the rarest of these blood types in humans?",answers:["AB+","AB-","O"],correct:1},{questionIndex:16,question:"Which of these is a botanical berry?",answers:["Strawberry","Banana","Apple"],correct:1},{questionIndex:15,question:"Which 17th-century Dutch legal scholar is known for laying the foundations of intern. law?",answers:["Hugo Grotius","Cornelis de Witt","Baruch Spinoza"],correct:0},{questionIndex:14,question:"Which country was formerly known as Abyssinia?",answers:["Sudan","Ethiopia","Libya"],correct:1},{questionIndex:13,question:"What part of the brain is responsible for balance and coordination?",answers:["Cerbrum","Brainstem","Cerebellum"],correct:2},{questionIndex:12,question:"Which Dutch island used to be part of the mainland before the Zuiderzee was formed?",answers:["Urk","Texel","Schiermonnikoog"],correct:0},{questionIndex:11,question:"In what year was the first email sent?",answers:["1981","1971","1965"],correct:1},{questionIndex:10,question:"What is the capital city of Canada?",answers:["Toronto","Ottowa","Vancouver"],correct:1},{questionIndex:9,question:"Which ocean lies between Africa and Australia?",answers:["Pacific","Indian","Southern"],correct:1},{questionIndex:8,question:"In Greek mythology, who is the god of the underworld?",answers:["Apollo","Zeus","Hades"],correct:2},{questionIndex:7,question:"In what year did King Willem-Alexander become king?",answers:["2011","2013","2015"],correct:1},{questionIndex:6,question:"Whats the smallest country in the world by land area?",answers:["Monaco","Vatican City","San Marino"],correct:1},{questionIndex:5,question:"Which metal has the chemical symbol Fe?",answers:["Iron","Silver","Lead"],correct:0},{questionIndex:4,question:"In which year did the Berlin Wall fall?",answers:["1991","1985","1989"],correct:2},{questionIndex:3,question:"What is the name of the longest bone in the human body?",answers:["Tibia","Femur","Humerus"],correct:1},{questionIndex:2,question:'In computing, what does "CPU" stand for?',answers:["Central Processing Unit","Central Power Unit","Computer Power Utility"],correct:0},{questionIndex:1,question:"How many legs does a spider have?",answers:["Six","Eight","Ten"],correct:1},{questionIndex:0,question:"Which planet is known as the Red Planet?",answers:["Mars","Venus","Jupiter"],correct:0}]}),Object.defineProperty(this,"questionData2",{enumerable:!0,configurable:!0,writable:!0,value:[{questionIndex:0,question:"Who was the 1st person in space?",answers:["Neil Armstrong","Gherman Titov","Yuri Gagarin"],correct:2},{questionIndex:1,question:"Whats the square root of 144?",answers:["10","12","20"],correct:1},{questionIndex:2,question:"A recipe calls for flour and sugar in the ratio 3:2. If you use 18 cups of flour, how much sugar should you use?",answers:["6 Cups","12 Cups","8 Cups"],correct:1},{questionIndex:3,question:"How many players are there in a Rugby Union team?",answers:["11","13","15"],correct:2},{questionIndex:4,question:"Whats the chemical symbol for Gold?",answers:["Ag","Au","Fe"],correct:1},{questionIndex:5,question:"What color is a Himalayan salt lamp typically?",answers:["Pink","White","Pale Blue"],correct:0},{questionIndex:6,question:"Who is the Greek god of the sea?",answers:["Atlas","Zeus","Poseiden"],correct:2},{questionIndex:7,question:"Which Dutch football club has won the most Eredivisie titles as of 2025?",answers:["Feyenoord","Ajax","PSV"],correct:1},{questionIndex:8,question:"What team did Brian Clough manage to two European Cups in Football?",answers:["Nottingham Forest","Liverpool","Manchester United"],correct:0},{questionIndex:9,question:"Whats the longest river in Asia?",answers:["Mekong","Yantze","Ganges"],correct:1},{questionIndex:10,question:"Who wrote the novel Moby-Dick?",answers:["Mark Twain","Herman Melville","F.Scott Fitzgerald"],correct:1},{questionIndex:11,question:"Which city is known for the oldest university in the Netherlands (founded 1575)?",answers:["Utrecht","Leiden","Nijmegen"],correct:1},{questionIndex:12,question:"What is the capital of Bhutan?",answers:["Thimphu","Kathmandu","Dhaka"],correct:0},{questionIndex:13,question:"Which Dutch poet wrote the line: 'Denkend aan Holland zie ik breede rivieren'?",answers:["J.C. Bloem","Hendrik Marsman","Martinus Nijhoff"],correct:1},{questionIndex:14,question:"Which author used the pen name Richard Bachman?",answers:["Stephen King","JK Rowling","Clive Barker"],correct:0},{questionIndex:15,question:"Which of these was a real programming language in the 1960s?",answers:["LISP","PYTHON","C++"],correct:0},{questionIndex:16,question:"Name the 17th-century mapmaker whose works are still widely reproduced today?",answers:["Blaeu","Hondius","Mercator"],correct:0},{questionIndex:17,question:"Who painted The Garden of Earthly Delights?",answers:["Hieronymus Bosch","Pieter Bruegel the Elder","Albrecht Drer"],correct:0},{questionIndex:18,question:"What was the name of Horatio Nelsons ship at the Battle of the Nile in 1798?",answers:["HMS Vanguard","HMS Victory","HMS Terror"],correct:0},{questionIndex:19,question:"Which film won Best Picture at the 2020 Academy Awards?",answers:["1917","Nomadland","Parasite"],correct:2},{questionIndex:20,question:"Which artist holds the record for the longest-running No. 1 single on the Billboard Hot 100?",answers:["Mariah Carey","Lil Nas X","Katy Perry"],correct:1}]}),Object.defineProperty(this,"questionData3",{enumerable:!0,configurable:!0,writable:!0,value:[{questionIndex:0,question:"What is the boiling point of water in Celsius?",answers:["0C","100C","101C"],correct:1},{questionIndex:1,question:"Which is not a primary color?",answers:["Red","Green","Blue"],correct:1},{questionIndex:2,question:"Who painted the Mona Lisa?",answers:["Vincent van Gogh","Leonardo da Vinci","Michelangelo"],correct:1},{questionIndex:3,question:"What language is primarily spoken in Brazil?",answers:["Spanish","Portuguese","French"],correct:1},{questionIndex:4,question:"What is the longest river flowing through the Netherlands?",answers:["Meuse (Maas)","Waal","Rhine (Rijn)"],correct:2},{questionIndex:5,question:"Who is the author of The Hobbit?",answers:["George R.R. Martin","Lewis Caroll","J.R.R. Tolkien"],correct:2},{questionIndex:6,question:"Which continent has the most countries?",answers:["Asia","Europe","Africa"],correct:2},{questionIndex:7,question:"Which blood type is a universal donor?",answers:["O-","AB+","AB-"],correct:0},{questionIndex:8,question:"Which ocean is the largest?",answers:["Atlantic","Indian","Pacific"],correct:2},{questionIndex:9,question:"What is the longest river in Europe?",answers:["Danube","Volga","Rhine"],correct:1},{questionIndex:10,question:"Which document limited the power of the monarchy and influenced the Dutch Republic's constitution?",answers:["Plakkaat van Verlatinghe","Union of Utrecht","Treaty of Breda"],correct:0},{questionIndex:11,question:"Who wrote the novel The Catcher in the Rye?",answers:["John Steinbeck","J.D. Salinger","Ernest Hemingway"],correct:1},{questionIndex:12,question:"Which battle marked the end of Napoleon's rule in 1815?",answers:["Austerlitz","Leipzig","Waterloo"],correct:2},{questionIndex:13,question:"What is the largest organ in the human body?",answers:["Skin","Liver","Heart"],correct:0},{questionIndex:14,question:"Which Nintendo character made his debut in the game Donkey Kong (1981)?",answers:["Pikachu","Mario","Sonic"],correct:1},{questionIndex:15,question:"What was the name of the Dutch ship that discovered parts of Australia in the 17th century?",answers:["De Zeven Provincin","Duyfken","Batavia"],correct:1},{questionIndex:16,question:"What political theory is Karl Popper known for critiquing?",answers:["Totalitarianism","Utopianism","Historicism"],correct:2},{questionIndex:17,question:"Which planet has the most moons?",answers:["Jupiter","Saturn","Neptune"],correct:1},{questionIndex:18,question:"What is an irrational number?",answers:["Cannot be a ratio of two integers","One that is imaginary","One that is undefined"],correct:0},{questionIndex:19,question:"Which Dutch mathematician developed early probability theory with Blaise Pascal?",answers:["Simon Stevin","Jan de Witt","Christiaan Huygens"],correct:1},{questionIndex:20,question:'In formal logic, what does the symbol "" mean?',answers:["Logical negation","Semantic Entailment","Biconditional"],correct:1}]}),Object.defineProperty(this,"transitions",{enumerable:!0,configurable:!0,writable:!0,value:{SPLASH:[o.INTRO],INTRO:[o.CHOOSE_ENVELOPE],CHOOSE_ENVELOPE:[o.INTRO_ROUND,o.END_ROUND],INTRO_ROUND:[o.QUESTION],QUESTION:[o.ANSWER],ANSWER:[o.QUESTION,o.END_ROUND],END_ROUND:[o.FINAL_CHOICE],FINAL_CHOICE:[o.PLAY_SAFE,o.GAMBLE],PLAY_SAFE:[o.END_QUIZ],CHECK_ENVELOPE:[o.END_QUIZ],GAMBLE:[o.GAMBLE_WON,o.GAMBLE_LOST],GAMBLE_WON:[o.END_QUIZ],GAMBLE_LOST:[o.END_QUIZ],END_QUIZ:[o.SAVE_RESULTS],SAVE_RESULTS:[o.SPLASH],DEBUG:[o.DEBUG]}}),Object.defineProperty(this,"stateActions",{enumerable:!0,configurable:!0,writable:!0,value:{SPLASH:()=>this.splash(),INTRO:()=>this.introQuiz(),CHOOSE_ENVELOPE:()=>this.chooseEnvelope(),INTRO_ROUND:()=>this.introRound(),QUESTION:()=>this.nextQuestion(),ANSWER:()=>this.showAnswer(),END_ROUND:()=>this.endRound(),FINAL_CHOICE:()=>this.finalChoice(),PLAY_SAFE:()=>this.playSafe(),CHECK_ENVELOPE:()=>this.checkEnvelope(),GAMBLE:()=>this.gamble(),GAMBLE_WON:()=>this.gambleWon(),GAMBLE_LOST:()=>this.gambleLost(),END_QUIZ:()=>this.endQuiz(),SAVE_RESULTS:()=>this.saveResults(),DEBUG:()=>this.debug()}}),Object.defineProperty(this,"FSM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stateDebugger",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moneyAmountsTree",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"questionNumbersTree",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"envelopeContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"envelopes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"correctAnswerContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"incorrectAnswerContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentQuestion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finalQuestion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finalEnvelope",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finalDecision",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thresholdAmount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"questionData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"safeCash",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"safeCashText",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}init(){console.log("MoneyTree.init: hello:"),super.init(),this.FSM=new i(o.SPLASH,this.transitions,this.stateActions)}preload(){this.load.image("borderbox","assets/rounded-rect-gold-black-200x80x12.png"),this.load.image("playernamepanel","assets/rounded-rect-paleblue-320x32x8.png"),this.load.image("envelope","assets/moneytree-envelope.png"),this.load.image("studio","assets/thetower-studio.jpg"),this.load.image("splash","assets/thetower-splash.jpg"),this.load.audio("lowtick",["assets/audio/moneytree-tick.mp3"]),this.load.audio("hightick",["assets/audio/moneytree-hightick.mp3"]),this.load.audio("answercorrect",["assets/audio/moneytree-answercorrect.wav"]),this.load.audio("answerincorrect",["assets/audio/moneytree-answerincorrect.wav"]),this.load.audio("envelopeopen",["assets/audio/moneytree-envelopeopen.mp3"]),this.load.audio("envelopeshuffle",["assets/audio/moneytree-envelopeshuffle.mp3"]),this.load.audio("highlightslot",["assets/audio/moneytree-highlightslot.mp3"]),this.load.rexWebFont({google:{families:["Titan One"]}})}create(){console.log("Phaser.create::",this.game.renderer.type===Phaser.WEBGL?"WebGL":"Canvas"),this.stateDebugger=new r(this,this.FSM,(t=>this.mockState(t))),this.input.keyboard&&this.input.keyboard.on("keydown-D",(t=>{t.ctrlKey&&t.altKey&&this.stateDebugger.toggle()})),this.FSM.start()}debug(){console.log("Debug: general purpose debug entry point...")}mockState(t){switch(console.log("mockState:",t),console.log(this.questions),t){case o.ANSWER:this.currentQuestion=this.questions[0],this.currentQuestion.selectedAnswerIndex=0;break;case o.END_ROUND:this.envelopeContainer.x=3e3;break;case o.END_QUIZ:this.envelopeContainer.x=3e3,this.currentQuestion=this.questions[0]}}splash(){console.log("splash: hello:");const t=this.add.image(0,0,"splash");console.log("Image:",t.displayWidth,t.displayHeight,t.scaleX,t.scaleY,t.width,t.height),t.scaleX=1920/t.width,t.scaleY=this.getY(1080)/t.height,t.setOrigin(0,0);const e=this.add.graphics();e.fillStyle(0,.6),e.fillRect(0,0,1920,this.getY(1080));const s=[this.questionData1,this.questionData2,this.questionData3],n=this.add.container();for(let t=0;t<3;t++){const e=this.add.text(480+480*t,this.getY(120),`Game ${t+1}`,{fontFamily:"Arial",color:"#000090",backgroundColor:"#000000",stroke:"#FFFFFF",strokeThickness:4,padding:{left:30,right:30,top:this.getY(20),bottom:this.getY(20)}}).setOrigin(.5).setFontSize(this.getY(48)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{a(t)})).on("pointerover",(()=>{e.setBackgroundColor("#333333")})).on("pointerout",(()=>e.setBackgroundColor("#000000")));n.add(e)}const i=this.add.text(960,this.getY(880),"An Iconic set that will get everyone talking",{fontFamily:"Titan One",fontSize:this.getY(60),color:"#9999bb",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setStroke("#000000",2),r=this.add.text(960,this.getY(960),"A gameshow mechanism that will get everyone watching!",{fontFamily:"Titan One",fontSize:this.getY(60),color:"#9999bb",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setStroke("#000000",2);n.add([i,r]);const a=t=>{this.questionData=s[t],e.fillStyle(0,.8),e.fillRect(0,0,1920,this.getY(1080)),this.FSM.transitionTo(o.INTRO)};this.FSM.onNextStateChange((()=>{n.destroy(!0)}))}setupDisplay(){const t=this.add.image(0,0,"studio");console.log("Image:",t.displayWidth,t.displayHeight,t.scaleX,t.scaleY,t.width,t.height),t.scaleX=1920/t.width,t.scaleY=this.getY(1080)/t.height,t.setOrigin(0,0);const e=this.add.graphics();e.fillStyle(0,.4),e.fillRect(0,0,1920,this.getY(1080)),this.questionNumbersTree=new c(this,Array.from({length:21},((t,e)=>""+(21-e))),80,this.getY(1020),this.getY(100)),this.moneyAmountsTree=new c(this,this.moneyamounts.map((t=>`$ ${t}`)),240,this.getY(1020),this.getY(100)),this.add.existing(this.questionNumbersTree),this.add.existing(this.moneyAmountsTree),this.questionNumbersTree.updateSlots("#000000","#ffffff","#000000"),this.envelopeContainer=this.add.container(400,0).setDepth(10),this.correctAnswerContainer=this.add.container(360,0),this.incorrectAnswerContainer=this.add.container(2e3,0).setDepth(1);const s=this.getY(920)/20,n=s/141;this.envelopes=[];for(let t=0;t<this.questionData.length;t++){const e=this.add.sprite(0,this.getY(100)+t*s,"envelope");e.setData("ID",t),e.setScale(n),this.envelopes.push(e),this.envelopeContainer.add(e)}}introQuiz(){Phaser.Utils.Array.Shuffle(this.questionData),this.questions=this.questionData.map(((t,e)=>new Ut(t,e))),this.setupDisplay(),console.log("introQuiz this:",this.questions);const t=this.add.container(),e=this.add.text(1280,this.getY(100),"How to Play",{fontFamily:"Arial",fontSize:"72px",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setStroke("#000000",2),s=this.add.text(720,this.getY(200),"We asked one hundred people to answer 21 questions\n\nWe then ranked the questions difficulty based on their answers\n\nThe questions were then assigned a monetary value\n\n$1 for the easiest question, all the way up to $100,000 for the hardest\n\nFinally, we placed each question into its own unmarked envelope",{fontFamily:"Arial",fontSize:"42px",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(0,0);s.setWordWrapWidth(1100);const n=this.add.text(1280,s.y+s.height+this.getY(120),"Continue",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:this.getY(10),bottom:this.getY(10)}}).setOrigin(.5).setFontSize(this.getY(48)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.sound.play("envelopeshuffle",{volume:.5}),this.FSM.transitionTo(o.CHOOSE_ENVELOPE)})).on("pointerover",(()=>n.setBackgroundColor("#0000ff"))).on("pointerout",(()=>n.setBackgroundColor("#000080")));t.add([e,s,n]),this.FSM.onNextStateChange((()=>{t.destroy(!0)}))}chooseEnvelope(){console.log("MoneyTree:: chooseEnvelope...");const t=this.add.container(),e=this.add.text(1280,this.getY(100),"ROUND 1:",{fontFamily:"Arial",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(72)),s=this.add.text(600,this.getY(200),"Choose a random envelope\n\nThis will be your question for the final round\n\nIt could be worth 100,000!\n\nClick on your envelope now",{fontFamily:"Arial",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(0,0).setFontSize(this.getY(32));s.setWordWrapWidth(1220),t.add([e,s]),this.FSM.onNextStateChange((()=>{t.destroy(!0)})),this.envelopes.forEach((t=>{t.setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{console.log("Envelope clicked:",t.getData("ID")),this.finalQuestion=this.questions[t.getData("ID")],this.finalEnvelope=t,t.off("pointerdown"),t.disableInteractive();const e=this.envelopeContainer.getWorldTransformMatrix(),s=e.tx+t.x*e.a+t.y*e.c,n=e.ty+t.x*e.b+t.y*e.d;this.envelopeContainer.remove(t),t.setPosition(s,n),this.tweens.add({targets:t,x:80,y:this.getY(48),duration:600,ease:"Sine.easeInOut",onComplete:()=>{this.FSM.transitionTo(o.INTRO_ROUND)}})})).on("pointerover",(()=>t.setTint(16711680))).on("pointerout",(()=>t.clearTint()))})),this.shuffleAndArrangeEnvelopes(5)}shuffleAndArrangeEnvelopes(t){const e=this.getY(840);console.log("shuffleAndArrangeEnvelopes:",t,1360,e),this.tweens.add({targets:this.envelopeContainer,x:1360,duration:500,ease:"Sine.easeInOut"});const s=this.envelopeContainer.list;let n=s.length;s.forEach((s=>{const i=Phaser.Math.FloatBetween(0,2*Math.PI),o=Phaser.Math.Between(150,350),r=Math.cos(i)*o,a=e+Math.sin(i)*o;this.tweens.add({targets:s,x:r,y:a,duration:400,ease:"Sine.easeInOut",onComplete:()=>{n--,0===n&&(t>0?this.shuffleAndArrangeEnvelopes(t-1):this.arrangeEnvelopesNeatly())}})}))}arrangeEnvelopesNeatly(){const t=this.getY(540),e=this.getY(300),s=this.envelopeContainer.list,n=s.length;if(0===s.length)return console.log("No envelopes to arrange! Current state:",this.FSM.getState()),void this.FSM.transitionTo(o.END_ROUND);this.tweens.add({targets:this.envelopeContainer,x:1320,duration:300,ease:"Sine.easeInOut"}),s.forEach(((s,i)=>{const o=i/n*Phaser.Math.PI2,r=300*Math.cos(o),a=t+Math.sin(o)*e;this.tweens.add({targets:s,x:r,y:a,duration:300})})),this.time.delayedCall(300,(()=>{this.rotateEnvelopesInCircle(0,t,e,2e4)}))}rotateEnvelopesInCircle(t,e,s,n=1e4){const i=this.envelopeContainer.list,o=i.length;i.forEach(((t,e)=>{t.setData("angle",e/o*Phaser.Math.PI2)})),this.tweens.addCounter({from:0,to:Phaser.Math.PI2,duration:n,repeat:-1,onUpdate:n=>{const o=n.getValue();i.forEach((n=>{const i=n.getData("angle")+o,r=t+Math.cos(i)*s,a=e+Math.sin(i)*s;n.setPosition(r,a)}))}})}introRound(){console.log("MoneyTree:: startRound..."),this.tweens.killTweensOf(this.envelopeContainer),this.tweens.add({targets:this.envelopeContainer,x:3840,duration:600,ease:"Sine.easeIn"});const t=this.add.container(),e=this.add.text(1280,this.getY(100),"ROUND 2:",{fontFamily:"Arial",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(72)),s=this.add.text(600,this.getY(200),"Now well start helping you figure out whats in your final envelope!\n\nIn Round 2, youll answer the remaining 20 questions. If you answer correctly:\n\n\tWe reveal that questions monetary value\n\tYou eliminate that amount from being a possible value of your final envelope\n\tYou win cash based on how many of the 100 contestants also answered correctly\n\nIf you answer incorrectly, you receive no information to aid you in the final",{fontFamily:"Arial",color:"#ffffff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(0,0).setFontSize(this.getY(32));s.setWordWrapWidth(1220);const n=this.add.text(1280,s.y+s.height+this.getY(120),"Continue",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:this.getY(10),bottom:this.getY(10)}}).setOrigin(.5).setFontSize(this.getY(48)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{t.destroy(!0),this.activateAllEnvelopes()})).on("pointerover",(()=>n.setBackgroundColor("#0000ff"))).on("pointerout",(()=>n.setBackgroundColor("#000080")));t.add([e,s,n]),this.safeCashText=this.add.text(1880,this.getY(1020),"CASH: $",{fontFamily:"Arial",color:"#cccc00",backgroundColor:"#000000",padding:{left:20,right:20,top:this.getY(8),bottom:this.getY(8)}}).setOrigin(1,.5).setFontSize(this.getY(60)).setVisible(!1)}nextQuestion(){console.log("MoneyTree:: nextQuestion..."),console.log("Current question:",this.currentQuestion),this.envelopeContainer.list.forEach((t=>{t.disableInteractive(),t.off("pointerdown")})),this.tweens.add({targets:this.envelopeContainer,x:3840,duration:600,ease:"Sine.easeIn",onComplete:()=>{this.showQuestion(this.currentQuestion)}})}showQuestion(t){console.log("MoneyTree:: showQuestion:",t),this.sound.play("envelopeopen",{volume:.5});const e=this.add.container(1200,0);Phaser.GameObjects.Text;const s=this.getY(100),n=this.getY(300),i=this.make.nineslice({x:0,y:s,key:"borderbox",width:1200,height:n,leftWidth:12,rightWidth:12,topHeight:12,bottomHeight:12,origin:{x:.5,y:0},add:!0}),r=this.add.text(0,s+n/2,t.question);r.setFontFamily("Arial").setFontSize(this.getY(40)).setColor("#ffffcc").setWordWrapWidth(1120).setOrigin(.5),e.add([i,r]);const a=s+n+this.getY(120);t.answers.forEach(((t,s)=>{const n=this.add.text(0,a+this.getY(100*s),t,{fontFamily:"Arial",color:"#ffffff",padding:{left:40,right:40,top:this.getY(10),bottom:this.getY(10)}}).setOrigin(.5).setFontSize(this.getY(40)).setBackgroundColor("#5555a0").setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.currentQuestion.selectedAnswerIndex=s,h(s)})).on("pointerover",(()=>n.setBackgroundColor("#8888FF"))).on("pointerout",(()=>n.setBackgroundColor("#5555a0")));e.add(n)}));const h=e=>{const s=e===t.correct;r.text=s?"Correct!":"Incorrect :(",r.setColor(s?"#00ff00":"#ff0000"),r.setFontSize(this.getY(48)),s?this.sound.play("answercorrect",{volume:.5}):this.sound.play("answerincorrect",{volume:.5}),this.time.delayedCall(1e3,(()=>{this.FSM.getState()===o.GAMBLE?this.FSM.transitionTo(s?o.GAMBLE_WON:o.GAMBLE_LOST):this.FSM.transitionTo(o.ANSWER)}))};this.FSM.onNextStateChange((()=>{e.destroy(!0)}))}showAnswer(){console.log("MoneyTree:: handleAnswer:",this.currentQuestion);const t=this.add.text(0,-100,this.currentQuestion.question).setFontFamily("Arial").setBackgroundColor("#111111").setColor("#bbbbbb").setPadding({left:40,right:40,top:this.getY(3),bottom:this.getY(3)}).setOrigin(0,.5).setFontSize(this.getY(32));this.currentQuestion.selectedAnswerIndex===this.currentQuestion.correct?this.moneyAmountsTree.animateCorrectAnswer(this.currentQuestion.questionIndex,(()=>{this.questionNumbersTree.setSlotState(this.currentQuestion.questionIndex,"revealed"),this.moneyAmountsTree.setSlotState(this.currentQuestion.questionIndex,"revealed");const e=this.questionNumbersTree.getSlotByIndex(this.currentQuestion.questionIndex).y;this.correctAnswerContainer.add(t),t.setPosition(0,e);const s=this.safeCash+75*(this.currentQuestion.questionIndex+1);this.tweens.add({targets:{value:this.safeCash},value:s,duration:1500,ease:"Linear",onUpdate:t=>{const e=t.getValue();this.safeCash=Math.round(e||0),this.safeCashText.setText(`CASH: $ ${this.safeCash}`).setVisible(!0)},onComplete:()=>{console.log("Cash tween complete:",this.safeCash)}}),this.activateAllEnvelopes()})):(this.incorrectAnswerContainer.add(t),this.arrangeIncorrectAnswers(),this.activateAllEnvelopes())}activateAllEnvelopes(){this.arrangeEnvelopesNeatly(),this.envelopeContainer.list.forEach((t=>{t.removeAllListeners(),t.setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{console.log("Envelope clicked:",t.getData("ID")),this.currentQuestion=this.questions[t.getData("ID")],this.envelopeContainer.remove(t),t.off("pointerdown"),t.destroy(),this.FSM.transitionTo(o.QUESTION)})).on("pointerover",(()=>t.setTint(16711680))).on("pointerout",(()=>t.clearTint()))}))}endRound(){console.log("MoneyTree:: END_ROUND"),this.correctAnswerContainer.y=this.getY(2e3);const t=this.add.container(),e=this.add.text(1280,this.getY(100),"YOUR FINAL CHOICE...",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(60)),s=this.add.text(600,this.getY(200),"Congratulations - you have made it to the end! Almost...\n\nYou have one final choice to make\n\nDo you want to KEEP the cash youve won so far?\nOr GAMBLE it all for the chance to answer the question in your Final envelope for hopefully a greater prize?\n\nIf you PLAY SAFE you walk away with your cash\n\nIf you GAMBLE you must answer the final question correctly to claim the amount in the envelope\n\nYou can review your answers in case that helps your decision\n\n",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:60,right:60,top:this.getY(20),bottom:this.getY(20)}}).setOrigin(0,0).setFontSize(this.getY(32)).setWordWrapWidth(1220),n=this.add.text(1280,s.y+s.height+this.getY(60),"I'M READY",{fontFamily:"Arial",fontSize:"48px",color:"#ffffff",backgroundColor:"#5555a0",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(o.FINAL_CHOICE)})).on("pointerover",(()=>n.setBackgroundColor("#8888FF"))).on("pointerout",(()=>n.setBackgroundColor("#5555a0"))),i=this.add.text(600,n.y+this.getY(60),"* we know you're not playing for money right now, but please try to make your choice based on what you think you really would do! Thanks :)").setOrigin(0,0).setFontSize(this.getY(32)).setWordWrapWidth(1220);t.add([e,s,n,i]),this.FSM.onNextStateChange((()=>{this.correctAnswerContainer.y=0,t.destroy(!0)}))}finalChoice(){console.log("MoneyTree:: Final Choice..."),this.currentQuestion=this.finalQuestion;const t=this.add.container().setDepth(10),e=this.add.text(1280,this.getY(100),"YOUR FINAL CHOICE...",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(60)).setVisible(!1),s=this.add.text(600,this.getY(200),"* we know you're not playing for money right now, but please try to make your choice based on what you think you really would do! Thanks :)",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(0,0).setFontSize(this.getY(32)).setWordWrapWidth(1260).setVisible(!1),n=Math.min(s.y+s.height+this.getY(280),this.getY(840)),i=this.add.text(960,n,"SAFE",{fontFamily:"Arial",color:"#000000",backgroundColor:"#a0a000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(72)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(o.PLAY_SAFE)})).on("pointerover",(()=>i.setBackgroundColor("#ffff00"))).on("pointerout",(()=>i.setBackgroundColor("#a0a000")));this.tweens.add({targets:this.safeCashText,x:960,y:i.y+this.getY(120),duration:500}),this.safeCashText.text=`$ ${this.safeCash}`,this.safeCashText.setOrigin(.5,.5);const r=this.add.text(1480,n,"GAMBLE",{fontFamily:"Arial",color:"#000000",backgroundColor:"#a00000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(72)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(o.GAMBLE)})).on("pointerover",(()=>r.setBackgroundColor("#ff0000"))).on("pointerout",(()=>r.setBackgroundColor("#a00000")));this.tweens.add({targets:this.finalEnvelope,x:r.x,y:r.y+this.getY(120),duration:500});const a=this.getY(60)/133;this.finalEnvelope.setScale(a),t.add([e,s,i,r,this.safeCashText,this.finalEnvelope]),this.FSM.onNextStateChange((()=>{this.incorrectAnswerContainer.setX(2e3),t.destroy(!0)}))}playSafe(){console.log("MoneyTree:: playSafe..."),this.finalDecision="SAFE";const t=this.add.container(),e=this.add.text(1280,this.getY(100),"PLAY SAFE!",{fontFamily:"Arial",fontSize:"72px",color:"#ffffff",backgroundColor:"#000000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setStroke("#000000",2),s=this.add.text(720,this.getY(200),`You played safe and walked away with $${this.safeCash} !\n\nLet's take a look at what you might have won...`,{fontFamily:"Arial",fontSize:"42px",color:"#ffffff",backgroundColor:"#000000",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(0,0).setStroke("#000000",2);s.setWordWrapWidth(1100),t.add([e,s]),this.FSM.onNextStateChange((()=>{t.destroy(!0)})),this.moneyAmountsTree.animateCorrectAnswer(this.currentQuestion.questionIndex,(()=>{console.log("MoneyTree:: playSafe - animation complete..."),this.FSM.transitionTo(o.END_QUIZ)}))}checkEnvelope(){console.log("MoneyTree:: checkEnvelope..."),this.moneyAmountsTree.animateCorrectAnswer(this.currentQuestion.questionIndex,(()=>{console.log("MoneyTree:: checkEnvelope - animation complete..."),this.FSM.transitionTo(o.END_QUIZ)}))}gamble(){console.log("MoneyTree:: gamble..."),this.showQuestion(this.currentQuestion),this.finalDecision="GAMBLE"}gambleWon(){this.finalDecision="GAMBLE - WON",this.moneyAmountsTree.animateCorrectAnswer(this.currentQuestion.questionIndex,(()=>{this.gambleWonMessage()}))}gambleWonMessage(){const t=this.currentQuestion.questionIndex,e=this.moneyamounts[t];console.log("MoneyTree:: gambleWon...:",t,e);const s=this.add.container().setDepth(10),n=this.add.text(1280,this.getY(100),"",{fontFamily:"Arial",fontSize:"72px",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(.5).setStroke("#000000",2),i=this.add.text(720,this.getY(160),"",{fontFamily:"Arial",fontSize:"42px",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(0,0);i.setWordWrapWidth(1100),e>2*this.safeCash?(n.setText("WOW!"),i.setText(`You answered the question correctly and won $${e}!\n\nIf you had played safe you would have walked away with $${this.safeCash}\n\nGreat result! Well played :)`)):e>this.safeCash?(n.setText("GOOD CHOICE!"),i.setText(`You answered the question correctly and won $${e}!\n\nYou could have played safe and only walked away with $${this.safeCash} but you made the right choice!`)):(n.setText("OUCH :("),i.setText(`You answered the question correctly but only won $${e}!\n\nYou could have played safe and walked away with $${this.safeCash}...:(\n\nOh well - better luck next time!`));const r=this.add.text(1280,i.y+i.height+this.getY(160),"OK",{fontFamily:"Arial",fontSize:"48px",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(o.END_QUIZ)})).on("pointerover",(()=>r.setBackgroundColor("#0000ff"))).on("pointerout",(()=>r.setBackgroundColor("#000080")));s.add([n,i,r]),this.FSM.onNextStateChange((()=>{s.destroy(!0)}))}gambleLost(){console.log("MoneyTree:: gambleLost..."),this.finalDecision="GAMBLE - LOST";const t=this.currentQuestion.questionIndex;this.moneyamounts[t];const e=this.add.container().setDepth(10),s=this.add.text(1280,this.getY(100),"",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(.5).setFontSize(this.getY(72)),n=this.add.text(720,this.getY(200),"",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000",padding:{left:60,right:60,top:this.getY(10),bottom:this.getY(10)}}).setOrigin(0,0).setFontSize(this.getY(42));n.setWordWrapWidth(1100),s.setText("OH DEAR..."),n.setText("You took the gamble and lost out on your BIG money prize... :(\n\nLet's see how much you would have won..."),e.add([s,n]),this.moneyAmountsTree.animateCorrectAnswer(t,(()=>{this.FSM.transitionTo(o.END_QUIZ)})),this.FSM.onNextStateChange((()=>{e.destroy(!0)}))}endQuiz(){console.log("MoneyTree:: endQuiz...");const t=this.currentQuestion.questionIndex,e=this.moneyamounts[t];this.correctAnswerContainer.x=2e3,console.log(this.questions),console.log("Final decision:",this.finalDecision),console.log("Safe cash amount:",this.safeCash),console.log("Gamble amount:",e);const s=this.add.container().setDepth(10),n=this.add.text(1280,this.getY(100),"Thanks for playing!",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(.5).setFontSize(this.getY(60)),i=this.add.text(720,this.getY(160),"",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(0,0).setFontSize(this.getY(40));i.setWordWrapWidth(1100),"SAFE"==this.finalDecision?i.setText("One last question: looking at the money tree, how low would the SAFE cash amount have needed to be for you to choose to GAMBLE?"):i.setText("One last question: looking at the money tree, how high would the SAFE cash amount have needed to be for you to choose to PLAY SAFE?");const r=720,a=i.y+i.height+this.getY(64),h=1100,c=r+this.safeCash/5e4*h,l=this.add.text(c,a+this.getY(64),`$ ${this.safeCash}`).setOrigin(.5).setFontSize(this.getY(32)).setFontFamily("Arial"),u=this.make.nineslice({x:r,y:a,key:"borderbox",width:h,height:24,leftWidth:12,rightWidth:12,topHeight:12,bottomHeight:12,origin:{x:0,y:.5},add:!0}),d=this.make.nineslice({x:c,y:a,key:"borderbox",width:24,height:64,leftWidth:12,rightWidth:12,topHeight:12,bottomHeight:12,origin:{x:.5,y:.5},add:!0});d.setInteractive(new Phaser.Geom.Rectangle(0,0,24,64),Phaser.Geom.Rectangle.Contains),this.input.setDraggable(d);var f=this.safeCash;this.input.on("drag",((t,e,s)=>{if(e===d){const t=Phaser.Math.Clamp(s,r,1820),e=(t-r)/h;f=5e4*Math.round(100*e)/100,l.setText(`$ ${f}`),l.x=t,d.x=t}}));const p=this.add.text(1280,i.y+i.height+this.getY(360),"OK",{fontFamily:"Arial",fontSize:"48px",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.thresholdAmount=f,this.FSM.transitionTo(o.SAVE_RESULTS)})).on("pointerover",(()=>p.setBackgroundColor("#0000ff"))).on("pointerout",(()=>p.setBackgroundColor("#000080")));s.add([n,i,p,l,u,d]),this.FSM.onNextStateChange((()=>{s.destroy(!0)}))}saveResults(){const t=this.currentQuestion.questionIndex,e=this.moneyamounts[t];console.log(this.questions);var s=this.questions.filter((t=>-1!==t.selectedAnswerIndex)).length,n=this.questions.filter((t=>t.selectedAnswerIndex==t.correct)).length;"SAFE"==this.finalDecision||(s-=1,"GAMBLE - WON"==this.finalDecision&&(n-=1));const i=[...this.questions].sort(((t,e)=>t.questionIndex-e.questionIndex));let r="";i.forEach((t=>{t.questionIndex===this.finalQuestion.questionIndex?r+="G":t.selectedAnswerIndex===t.correct?r+="X":r+="."})),console.log("Questions answered:",s),console.log("Questions correct:",n),console.log("Final decision:",this.finalDecision),console.log("Safe cash amount:",this.safeCash),console.log("Gamble amount:",e),console.log("Threhold amount:",this.thresholdAmount),console.log("Results:",r),this.socket.emit("client:saveresults",`${s}\t${n}\t${this.safeCash}\t${e}\t${this.thresholdAmount}\t${this.finalDecision}\t${r}`);const a=this.add.container().setDepth(10),h=this.add.text(1280,this.getY(100),"Thanks for playing!",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(.5).setFontSize(this.getY(60)),c=this.add.text(720,this.getY(160),"",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000000"}).setOrigin(0,0).setFontSize(this.getY(40));c.setWordWrapWidth(1100),c.setText(`Answered correctly: ${n} out of ${s}\nSafe cash: $ ${this.safeCash}\nMoneytree prize: $ ${e}\nYour result: ${this.finalDecision}\n\nClick 'PLAY AGAIN' if you'd like to try with a different set of questions`);const l=this.add.text(1280,c.y+c.height+this.getY(360),"PLAY AGAIN",{fontFamily:"Arial",color:"#ffffff",backgroundColor:"#000080",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setFontSize(this.getY(48)).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.FSM.transitionTo(o.SPLASH)})).on("pointerover",(()=>l.setBackgroundColor("#0000ff"))).on("pointerout",(()=>l.setBackgroundColor("#000080")));a.add([h,c,l]),this.FSM.onNextStateChange((()=>{a.destroy(!0)}))}getPlayerBySessionID(t){return this.add.container(0,0)}arrangeIncorrectAnswers(){const t=this.incorrectAnswerContainer.list,e=this.getY(48);t.forEach(((t,s)=>{const n=s*e;t.setY(n)}))}sceneShutdown(){console.log("MoneyTree:: sceneShutdown...")}},parent:"container"};if(!("PhaserGameInstance"in window)){const t=new Phaser.Game(zt);console.log("Standalone MoneyTree game created:",t),window.PhaserGameInstance=t}}();
//# sourceMappingURL=moneytreenl.min.js.map
